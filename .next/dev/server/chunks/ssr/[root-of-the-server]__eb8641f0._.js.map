{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/aixingren/ai-essay-editor/components/ui/textarea.tsx"],"sourcesContent":["import * as React from 'react'\n\nimport { cn } from '@/lib/utils'\n\nfunction Textarea({ className, ...props }: React.ComponentProps<'textarea'>) {\n  return (\n    <textarea\n      data-slot=\"textarea\"\n      className={cn(\n        'border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm',\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nexport { Textarea }\n"],"names":[],"mappings":";;;;;AAEA;;;AAEA,SAAS,SAAS,EAAE,SAAS,EAAE,GAAG,OAAyC;IACzE,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,IAAA,kHAAE,EACX,ucACA;QAED,GAAG,KAAK;;;;;;AAGf","debugId":null}},
    {"offset": {"line": 28, "column": 0}, "map": {"version":3,"sources":["file:///Users/aixingren/ai-essay-editor/components/ui/scroll-area.tsx"],"sourcesContent":["'use client'\n\nimport * as React from 'react'\nimport * as ScrollAreaPrimitive from '@radix-ui/react-scroll-area'\n\nimport { cn } from '@/lib/utils'\n\nfunction ScrollArea({\n  className,\n  children,\n  ...props\n}: React.ComponentProps<typeof ScrollAreaPrimitive.Root>) {\n  return (\n    <ScrollAreaPrimitive.Root\n      data-slot=\"scroll-area\"\n      className={cn('relative', className)}\n      {...props}\n    >\n      <ScrollAreaPrimitive.Viewport\n        data-slot=\"scroll-area-viewport\"\n        className=\"focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1\"\n      >\n        {children}\n      </ScrollAreaPrimitive.Viewport>\n      <ScrollBar />\n      <ScrollAreaPrimitive.Corner />\n    </ScrollAreaPrimitive.Root>\n  )\n}\n\nfunction ScrollBar({\n  className,\n  orientation = 'vertical',\n  ...props\n}: React.ComponentProps<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>) {\n  return (\n    <ScrollAreaPrimitive.ScrollAreaScrollbar\n      data-slot=\"scroll-area-scrollbar\"\n      orientation={orientation}\n      className={cn(\n        'flex touch-none p-px transition-colors select-none',\n        orientation === 'vertical' &&\n          'h-full w-2.5 border-l border-l-transparent',\n        orientation === 'horizontal' &&\n          'h-2.5 flex-col border-t border-t-transparent',\n        className,\n      )}\n      {...props}\n    >\n      <ScrollAreaPrimitive.ScrollAreaThumb\n        data-slot=\"scroll-area-thumb\"\n        className=\"bg-border relative flex-1 rounded-full\"\n      />\n    </ScrollAreaPrimitive.ScrollAreaScrollbar>\n  )\n}\n\nexport { ScrollArea, ScrollBar }\n"],"names":[],"mappings":";;;;;;;AAGA;AAEA;AALA;;;;AAOA,SAAS,WAAW,EAClB,SAAS,EACT,QAAQ,EACR,GAAG,OACmD;IACtD,qBACE,8OAAC,kLAAwB;QACvB,aAAU;QACV,WAAW,IAAA,kHAAE,EAAC,YAAY;QACzB,GAAG,KAAK;;0BAET,8OAAC,sLAA4B;gBAC3B,aAAU;gBACV,WAAU;0BAET;;;;;;0BAEH,8OAAC;;;;;0BACD,8OAAC,oLAA0B;;;;;;;;;;;AAGjC;AAEA,SAAS,UAAU,EACjB,SAAS,EACT,cAAc,UAAU,EACxB,GAAG,OACkE;IACrE,qBACE,8OAAC,iMAAuC;QACtC,aAAU;QACV,aAAa;QACb,WAAW,IAAA,kHAAE,EACX,sDACA,gBAAgB,cACd,8CACF,gBAAgB,gBACd,gDACF;QAED,GAAG,KAAK;kBAET,cAAA,8OAAC,6LAAmC;YAClC,aAAU;YACV,WAAU;;;;;;;;;;;AAIlB","debugId":null}},
    {"offset": {"line": 98, "column": 0}, "map": {"version":3,"sources":["file:///Users/aixingren/ai-essay-editor/components/chat/analysis-stages.tsx"],"sourcesContent":["\"use client\"\nimport { CheckCircle2, Sparkles } from \"lucide-react\"\nimport { useEffect, useState } from \"react\"\n\ninterface Stage {\n  id: number\n  title: string\n  description: string\n}\n\nconst stages: Stage[] = [\n  {\n    id: 1,\n    title: \"ÊñáÊ°£Ëß£Êûê\",\n    description: \"Ê≠£Âú®ËØÜÂà´ÊñáÂ≠óÂÜÖÂÆπÂíåÂõæÁâá‰ø°ÊÅØ...\",\n  },\n  {\n    id: 2,\n    title: \"Êô∫ËÉΩÂàÜÊûê\",\n    description: \"AIÊ≠£Âú®Ê∑±Â∫¶ÁêÜËß£ÊñáÁ´†Á´ãÊÑèÂíåÁªìÊûÑ...\",\n  },\n  {\n    id: 3,\n    title: \"ÂÖ®Èù¢ËØÑ‰º∞\",\n    description: \"ÂàÜÊûêËØ≠Ë®ÄË°®Ëææ„ÄÅËÆ∫ËØÅÈÄªËæëÂíåÂàõÊÑè‰∫ÆÁÇπ...\",\n  },\n  {\n    id: 4,\n    title: \"ÁîüÊàêÂª∫ËÆÆ\",\n    description: \"ÊèêÁÇº‰ºòÁÇπÂíåÊîπËøõÊñπÂêëÔºåÊâìÁ£®ÊâπÊîπÊä•Âëä...\",\n  },\n  {\n    id: 5,\n    title: \"ÂÆåÊàêÊâπÊîπ\",\n    description: \"ÊâπÊîπÊä•ÂëäÂ∑≤ÁîüÊàêÔºåÊ≠£Âú®‰∏∫ÊÇ®ÂëàÁé∞...\",\n  },\n]\n\nexport function AnalysisStages() {\n  const [currentStage, setCurrentStage] = useState(0)\n  const [progress, setProgress] = useState(0)\n\n  useEffect(() => {\n    const stageInterval = setInterval(() => {\n      setCurrentStage((prev) => {\n        if (prev < stages.length - 1) {\n          return prev + 1\n        }\n        return prev\n      })\n    }, 2000)\n\n    const progressInterval = setInterval(() => {\n      setProgress((prev) => {\n        const targetProgress = ((currentStage + 1) / stages.length) * 100\n        if (prev < targetProgress) {\n          return Math.min(prev + 1, 100)\n        }\n        return prev\n      })\n    }, 20)\n\n    return () => {\n      clearInterval(stageInterval)\n      clearInterval(progressInterval)\n    }\n  }, [currentStage])\n\n  return (\n    <div className=\"flex items-center justify-center min-h-[500px] p-4\">\n      <div className=\"w-full max-w-md\">\n        <div className=\"bg-[#f5f1e8] rounded-3xl p-6 shadow-lg border border-amber-200/50\">\n          <div className=\"flex items-start justify-between mb-4\">\n            <div className=\"flex items-center gap-3\">\n              <div className=\"flex h-12 w-12 items-center justify-center rounded-xl bg-gradient-to-br from-emerald-700 to-emerald-900 shadow-md\">\n                <Sparkles className=\"h-6 w-6 text-white\" />\n              </div>\n              <div>\n                <h3 className=\"text-lg font-bold text-gray-800\">AI Êô∫ËÉΩÊâπÊîπËøõË°å‰∏≠</h3>\n                <p className=\"text-sm text-gray-600\">\n                  Èò∂ÊÆµ {currentStage + 1} / {stages.length}\n                </p>\n              </div>\n            </div>\n            <div className=\"text-right\">\n              <div className=\"text-3xl font-bold text-gray-800\">{Math.round(progress)}%</div>\n              <div className=\"text-xs text-gray-600\">Â∑≤ÂÆåÊàê</div>\n            </div>\n          </div>\n\n          <div className=\"mb-6 h-2 w-full overflow-hidden rounded-full bg-gray-200\">\n            <div\n              className=\"h-full rounded-full bg-gradient-to-r from-green-500 via-yellow-400 to-orange-500 transition-all duration-300 ease-out\"\n              style={{ width: `${progress}%` }}\n            />\n          </div>\n\n          <div className=\"space-y-3\">\n            {stages.map((stage, index) => {\n              const isCompleted = index < currentStage\n              const isCurrent = index === currentStage\n\n              return (\n                <div\n                  key={stage.id}\n                  className={`flex items-center gap-3 rounded-2xl border p-4 transition-all ${\n                    isCurrent\n                      ? \"border-emerald-300 bg-emerald-50/80 shadow-md\"\n                      : isCompleted\n                        ? \"border-emerald-200 bg-white\"\n                        : \"border-gray-200 bg-white/50\"\n                  }`}\n                >\n                  <div\n                    className={`flex h-10 w-10 flex-shrink-0 items-center justify-center rounded-full ${\n                      isCompleted || isCurrent ? \"bg-emerald-700\" : \"bg-gray-300\"\n                    }`}\n                  >\n                    <CheckCircle2 className={`h-5 w-5 ${isCompleted || isCurrent ? \"text-white\" : \"text-gray-500\"}`} />\n                  </div>\n\n                  <div className=\"flex-1 min-w-0\">\n                    <div className=\"font-semibold text-gray-800\">{stage.title}</div>\n                    <div className=\"text-sm text-gray-600 truncate\">{stage.description}</div>\n                  </div>\n\n                  {isCurrent && (\n                    <div className=\"flex gap-1\">\n                      {[0, 1, 2].map((i) => (\n                        <div\n                          key={i}\n                          className=\"h-2 w-2 rounded-full bg-emerald-700 animate-bounce\"\n                          style={{\n                            animationDelay: `${i * 150}ms`,\n                            animationDuration: \"600ms\",\n                          }}\n                        />\n                      ))}\n                    </div>\n                  )}\n                </div>\n              )\n            })}\n          </div>\n\n          <div className=\"mt-4 flex items-start gap-2 rounded-xl bg-amber-50 px-4 py-3 border border-amber-200\">\n            <span className=\"text-base\">üí°</span>\n            <p className=\"text-xs text-gray-600 leading-relaxed\">AI Ê≠£Âú®‰∏∫ÊÇ®Á≤æÂøÉÊâìÁ£®ÊâπÊîπÊä•ÂëäÔºåËØ∑Á®çÂÄôÁâáÂàª...</p>\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 462, "column": 0}, "map": {"version":3,"sources":["file:///Users/aixingren/ai-essay-editor/components/chat/enhanced-chat-interface.tsx"],"sourcesContent":["\"use client\"\n\nimport type React from \"react\"\nimport { useState, useRef, useEffect } from \"react\"\nimport { useChat } from \"ai/react\"\nimport { Button } from \"@/components/ui/button\"\nimport { Textarea } from \"@/components/ui/textarea\"\nimport { ScrollArea } from \"@/components/ui/scroll-area\"\nimport { Send, Paperclip, X, FileText, Copy, Check, Loader2, User } from \"lucide-react\"\nimport { cn } from \"@/lib/utils\"\nimport { toast } from \"sonner\"\nimport { AnalysisStages } from \"./analysis-stages\"\n\n// ‚úÖ ÊÅ¢Â§ç‰ΩøÁî®‰∏ì‰∏öÊ∏≤ÊüìÂ∫ì (ÈúÄÁ°Æ‰øùÂ∑≤ËøêË°å npm install react-markdown remark-gfm --legacy-peer-deps)\nimport ReactMarkdown from \"react-markdown\"\nimport remarkGfm from \"remark-gfm\"\n\ntype UploadedFile = {\n  name: string\n  type: string\n  size: number\n  data: string\n  preview?: string\n}\n\nexport function EnhancedChatInterface() {\n  const [userId, setUserId] = useState<string>(\"\")\n  \n  useEffect(() => {\n    if (typeof window !== 'undefined') {\n      const userStr = localStorage.getItem('currentUser')\n      if (userStr) {\n        try {\n          const user = JSON.parse(userStr)\n          setUserId(user.id || user.sub || \"\")\n        } catch (e) {\n          console.error(\"ËØªÂèñÁî®Êà∑‰ø°ÊÅØÂ§±Ë¥•\", e)\n        }\n      }\n    }\n  }, [])\n\n  const [uploadedFiles, setUploadedFiles] = useState<UploadedFile[]>([])\n  const [copiedMessageId, setCopiedMessageId] = useState<string | null>(null)\n  const [analysisStage, setAnalysisStage] = useState(0)\n  \n  const fileInputRef = useRef<HTMLInputElement>(null)\n  const messagesEndRef = useRef<HTMLDivElement>(null)\n  const textareaRef = useRef<HTMLTextAreaElement>(null)\n\n  const { messages, input, handleInputChange, handleSubmit, isLoading, append, setMessages } = useChat({\n    api: '/api/chat',\n    body: {\n      userId: userId,\n      files: uploadedFiles,\n    },\n    onResponse: (response: any) => {\n      if (!response.ok) {\n        if (response.status === 402) {\n          toast.error(\"ÁßØÂàÜ‰∏çË∂≥ÔºåËØ∑ÂâçÂæÄÂçáÁ∫ßÂ•óÈ§êÔºÅ\")\n        } else {\n          toast.error(`ËØ∑Ê±ÇÂ§±Ë¥•: ${response.statusText}`)\n        }\n      }\n    },\n    onFinish: (message: any) => {\n      setAnalysisStage(4)\n    },\n    onError: (error: any) => {\n      console.error(\"Chat error:\", error)\n      if (error?.message?.includes(\"ÁßØÂàÜ‰∏çË∂≥\")) {\n         toast.error(\"ÊÇ®ÁöÑÁßØÂàÜ‰∏çË∂≥ÔºåËØ∑ÂÖÖÂÄºÔºÅ\")\n      } else {\n         toast.error(\"ÂèëÁîüÈîôËØØÔºåËØ∑ÈáçËØï\")\n      }\n    }\n  })\n\n  // Ëá™Âä®ÊªöÂä®\n  useEffect(() => {\n    messagesEndRef.current?.scrollIntoView({ behavior: \"smooth\" })\n  }, [messages])\n\n  // Ê®°ÊãüÂàÜÊûêÈò∂ÊÆµÂä®Áîª\n  useEffect(() => {\n    if (isLoading && analysisStage < 4) {\n      const timer = setTimeout(\n        () => {\n          setAnalysisStage((prev) => Math.min(prev + 1, 4))\n        },\n        2000 + Math.random() * 1000,\n      )\n      return () => clearTimeout(timer)\n    } else if (!isLoading) {\n      setAnalysisStage(0)\n    }\n  }, [isLoading, analysisStage])\n\n\n  const handleFileUpload = async (event: React.ChangeEvent<HTMLInputElement>) => {\n    const files = event.target.files\n    if (!files || files.length === 0) return\n\n    const newFiles: UploadedFile[] = []\n\n    for (let i = 0; i < files.length; i++) {\n      const file = files[i]\n      try {\n        const reader = new FileReader()\n        const fileData = await new Promise<string>((resolve) => {\n          reader.onload = (e) => resolve(e.target?.result as string)\n          reader.readAsDataURL(file)\n        })\n\n        const uploadedFile: UploadedFile = {\n          name: file.name,\n          type: file.type,\n          size: file.size,\n          data: fileData,\n        }\n\n        if (file.type.startsWith(\"image/\")) {\n          uploadedFile.preview = fileData\n        }\n        newFiles.push(uploadedFile)\n      } catch (error) {\n        toast.error(`${file.name} ËØªÂèñÂ§±Ë¥•`)\n      }\n    }\n    setUploadedFiles((prev) => [...prev, ...newFiles])\n    if (fileInputRef.current) fileInputRef.current.value = \"\"\n  }\n\n  const removeFile = (index: number) => {\n    setUploadedFiles((prev) => prev.filter((_, i) => i !== index))\n  }\n\n  // ‚ú® Ê†∏ÂøÉ‰øÆÂ§çÔºöËß£ÂÜ≥Âè™ÂèëÂõæÁâá‰∏çÂèëÊñáÂ≠óÊó∂ÁöÑ‚ÄúÊó†ÂèçÂ∫î‚ÄùÈóÆÈ¢ò\n  const onSubmit = async (e: React.FormEvent) => {\n    e.preventDefault()\n    \n    if (!userId) {\n      toast.error(\"Êú™ÁôªÂΩïÔºåÊó†Ê≥ï‰ΩøÁî® AI ÂäüËÉΩ\")\n      return\n    }\n\n    if (!input.trim() && uploadedFiles.length === 0) return\n\n    // Â¶ÇÊûúÂè™ÊúâÂõæÁâáÊ≤°ÊúâÊñáÂ≠óÔºåÊâãÂä®Ë∞ÉÁî® append ÂèëÈÄÅ‰∏Ä‰∏™ÈªòËÆ§ÊèêÁ§∫ËØç\n    if (!input.trim() && uploadedFiles.length > 0) {\n       await append({\n         role: 'user',\n         content: \"ËØ∑Â∏ÆÊàëÊâπÊîπËøô‰ªΩ‰Ωú‰∏ö\", // Ëá™Âä®Â°´ÂÖÖÊèêÁ§∫ËØç\n         // @ts-ignore - ÂøΩÁï• TS Á±ªÂûãÊ£ÄÊü•ÔºåÁ°Æ‰øùÊñá‰ª∂ËÉΩ‰º†ËøáÂéª\n         experimental_attachments: uploadedFiles.map(f => ({ \n             name: f.name, \n             contentType: f.type, \n             url: f.data \n         }))\n       })\n       setUploadedFiles([])\n       setAnalysisStage(0)\n       return\n    }\n\n    // Ê≠£Â∏∏ÂèëÈÄÅ\n    handleSubmit(e)\n    setUploadedFiles([])\n    setAnalysisStage(0)\n  }\n\n  const handleKeyDown = (e: React.KeyboardEvent<HTMLTextAreaElement>) => {\n    if (e.key === \"Enter\" && !e.shiftKey) {\n      e.preventDefault()\n      onSubmit(e as unknown as React.FormEvent)\n    }\n  }\n\n  const copyToClipboard = async (text: string, messageId: string) => {\n    try {\n      await navigator.clipboard.writeText(text)\n      setCopiedMessageId(messageId)\n      toast.success(\"Â∑≤Â§çÂà∂\")\n      setTimeout(() => setCopiedMessageId(null), 2000)\n    } catch (error) {\n      toast.error(\"Â§çÂà∂Â§±Ë¥•\")\n    }\n  }\n\n  return (\n    <div className=\"flex h-screen flex-col bg-[#F9FAFB]\">\n      <ScrollArea className=\"flex-1 p-4\">\n        <div className=\"mx-auto max-w-4xl space-y-8 pb-10\">\n          {messages.length === 0 ? (\n            <div className=\"flex flex-col items-center justify-center py-20 text-center\">\n              <div className=\"mb-6 flex h-20 w-20 items-center justify-center rounded-3xl bg-white shadow-lg shadow-gray-200/50\">\n                <FileText className=\"h-10 w-10 text-primary\" />\n              </div>\n              <h1 className=\"mb-4 text-3xl font-bold tracking-tight text-gray-900\">‰Ω†Â•ΩÔºÅÊ¨¢Ëøé‰ΩøÁî®Ê≤àÁøîÊô∫Â≠¶ÔºÅ</h1>\n              <p className=\"max-w-lg text-gray-500\">\n                ‰∏ä‰º†ÊÇ®ÁöÑ‰ΩúÊñáÂõæÁâáÊàñÁõ¥Êé•ËæìÂÖ•ÊñáÂ≠óÔºå‰∏ì‰∏öÁöÑ AI ËÄÅÂ∏àÂ∞Ü‰∏∫ÊÇ®Êèê‰æõÊ∑±Â∫¶ÁÇπËØÑÂíåÊîπËøõÂª∫ËÆÆ„ÄÇ\n              </p>\n            </div>\n          ) : (\n            <div className=\"space-y-6\">\n              {messages.map((message) => (\n                <div\n                  key={message.id}\n                  className={cn(\"flex gap-4\", message.role === \"user\" ? \"justify-end\" : \"justify-start\")}\n                >\n                  {message.role === \"assistant\" && (\n                    <div className=\"flex h-10 w-10 shrink-0 items-center justify-center rounded-full bg-primary text-white shadow-md\">\n                      <FileText className=\"h-5 w-5\" />\n                    </div>\n                  )}\n                  \n                  <div\n                    className={cn(\n                      \"relative overflow-hidden rounded-2xl px-5 py-4 shadow-sm\",\n                      message.role === \"user\"\n                        ? \"bg-primary text-primary-foreground max-w-[80%]\"\n                        : \"bg-white text-gray-800 border border-gray-100 max-w-full w-full\"\n                    )}\n                  >\n                    {/* Áî®Êà∑Ê∂àÊÅØ */}\n                    {message.role === \"user\" ? (\n                      <div className=\"whitespace-pre-wrap text-sm leading-7\">{message.content}</div>\n                    ) : (\n                      // AI Ê∂àÊÅØ\n                      isLoading && !message.content ? <AnalysisStages /> : \n                      <div className=\"prose prose-sm max-w-none prose-headings:font-bold prose-headings:text-gray-900 prose-p:text-gray-600 prose-p:leading-7 prose-strong:text-primary prose-strong:font-bold\">\n                        <ReactMarkdown\n                          remarkPlugins={[remarkGfm]} \n                          components={{\n                            table: ({node, ...props}) => (\n                              <div className=\"my-4 overflow-hidden rounded-lg border border-gray-200 shadow-sm\">\n                                <table className=\"min-w-full divide-y divide-gray-200 bg-gray-50\" {...props} />\n                              </div>\n                            ),\n                            thead: ({node, ...props}) => <thead className=\"bg-gray-800 text-white\" {...props} />,\n                            th: ({node, ...props}) => <th className=\"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider\" {...props} />,\n                            td: ({node, ...props}) => <td className=\"px-4 py-3 text-sm text-gray-600 border-t border-gray-100 bg-white\" {...props} />,\n                            blockquote: ({node, ...props}) => (\n                              <blockquote className=\"my-4 border-l-4 border-primary bg-primary/5 p-4 italic text-gray-700\" {...props} />\n                            ),\n                          }}\n                        >\n                          {/* ‚ú® ÂÆâÂÖ®‰øÆÂ§çÔºöÁ°Æ‰øùÂÜÖÂÆπ‰∏ç‰∏∫ undefinedÔºåÈò≤Ê≠¢Â¥©Ê∫É */}\n                          {message.content || \"\"}\n                        </ReactMarkdown>\n                      </div>\n                    )}\n\n                    {message.role === \"assistant\" && message.content && (\n                      <div className=\"mt-4 flex items-center justify-end gap-2 border-t border-gray-100 pt-3\">\n                        <Button\n                          variant=\"ghost\"\n                          size=\"sm\"\n                          className=\"h-8 gap-1.5 text-xs text-gray-400 hover:text-primary\"\n                          onClick={() => copyToClipboard(message.content, message.id)}\n                        >\n                          {copiedMessageId === message.id ? <Check className=\"h-3.5 w-3.5\" /> : <Copy className=\"h-3.5 w-3.5\" />}\n                          Â§çÂà∂ÂÖ®Êñá\n                        </Button>\n                      </div>\n                    )}\n                  </div>\n\n                  {message.role === \"user\" && (\n                    <div className=\"flex h-10 w-10 shrink-0 items-center justify-center rounded-full bg-gray-200 shadow-sm\">\n                      <User className=\"h-5 w-5 text-gray-600\" />\n                    </div>\n                  )}\n                </div>\n              ))}\n              <div ref={messagesEndRef} />\n            </div>\n          )}\n        </div>\n      </ScrollArea>\n\n      <div className=\"border-t border-gray-100 bg-white p-4 pb-6 shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.05)]\">\n        <div className=\"mx-auto max-w-4xl\">\n          {uploadedFiles.length > 0 && (\n            <div className=\"mb-3 flex flex-wrap gap-2\">\n              {uploadedFiles.map((file, index) => (\n                <div key={index} className=\"flex items-center gap-2 rounded-lg border border-gray-200 bg-gray-50 px-3 py-2 text-sm shadow-sm\">\n                  {file.preview ? (\n                    <img src={file.preview} alt={file.name} className=\"h-8 w-8 rounded object-cover\" />\n                  ) : <FileText className=\"h-4 w-4 text-gray-500\" />}\n                  <span className=\"max-w-[100px] truncate text-gray-700\">{file.name}</span>\n                  <button onClick={() => removeFile(index)} className=\"ml-1 text-gray-400 hover:text-red-500\"><X className=\"h-3 w-3\" /></button>\n                </div>\n              ))}\n            </div>\n          )}\n\n          <form onSubmit={onSubmit} className=\"relative flex gap-3\">\n             <Button\n                type=\"button\"\n                variant=\"outline\"\n                size=\"icon\"\n                className=\"h-12 w-12 shrink-0 rounded-xl border-gray-200 text-gray-500 hover:bg-gray-50 hover:text-primary\"\n                onClick={() => fileInputRef.current?.click()}\n                disabled={isLoading}\n              >\n                <Paperclip className=\"h-5 w-5\" />\n              </Button>\n              <input ref={fileInputRef} type=\"file\" className=\"hidden\" accept=\"image/*,.txt,.doc,.docx\" multiple onChange={handleFileUpload} />\n              \n              <div className=\"relative flex-1\">\n                <Textarea\n                  ref={textareaRef}\n                  value={input}\n                  onChange={handleInputChange}\n                  onKeyDown={handleKeyDown}\n                  placeholder={userId ? \"Âú®Ê≠§ËæìÂÖ•‰ΩúÊñáÂÜÖÂÆπÔºåÊàñ‰∏ä‰º†ÂõæÁâá...\" : \"ËØ∑ÂÖàÁôªÂΩï...\"}\n                  className=\"min-h-[48px] w-full resize-none rounded-xl border-gray-200 bg-gray-50 py-3 pl-4 pr-12 text-gray-900 placeholder:text-gray-400 focus:border-primary focus:bg-white focus:ring-1 focus:ring-primary\"\n                  disabled={isLoading}\n                  rows={1}\n                />\n                <Button\n                  type=\"submit\"\n                  size=\"icon\"\n                  className={cn(\"absolute right-1.5 top-1.5 h-9 w-9 rounded-lg transition-all\", isLoading ? \"bg-gray-200\" : \"bg-primary text-white hover:bg-primary/90 shadow-sm\")}\n                  disabled={isLoading || (!input.trim() && uploadedFiles.length === 0)}\n                >\n                  {isLoading ? <Loader2 className=\"h-4 w-4 animate-spin\" /> : <Send className=\"h-4 w-4\" />}\n                </Button>\n              </div>\n          </form>\n          <div className=\"mt-2 text-center text-xs text-gray-400\">\n            {userId ? \"ÊØèÊ¨°ÊâπÊîπÊ∂àËÄó 250 ÁßØÂàÜ ¬∑ AI ÁîüÊàêÂÜÖÂÆπ‰ªÖ‰æõÂèÇËÄÉ\" : \"Êú™ÁôªÂΩïÁä∂ÊÄÅ\"}\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1044, "column": 0}, "map": {"version":3,"sources":["file:///Users/aixingren/ai-essay-editor/app/chat/page.tsx"],"sourcesContent":["\"use client\"\n\nimport { EnhancedChatInterface } from \"@/components/chat/enhanced-chat-interface\"\n\nexport default function ChatPage() {\n  return (\n    <main className=\"flex min-h-screen flex-col\">\n      {/* Header component removed */}\n      <div className=\"flex-1\">\n        <EnhancedChatInterface />\n      </div>\n    </main>\n  )\n}\n"],"names":[],"mappings":";;;;;AAEA;AAFA;;;AAIe,SAAS;IACtB,qBACE,8OAAC;QAAK,WAAU;kBAEd,cAAA,8OAAC;YAAI,WAAU;sBACb,cAAA,8OAAC,6KAAqB;;;;;;;;;;;;;;;AAI9B","debugId":null}}]
}