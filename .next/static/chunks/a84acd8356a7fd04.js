(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,69756,e=>{"use strict";var t=e.i(58846),r=e.i(68901),n=e.i(84739),s=e.i(62893),a=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"].reduce((e,r)=>{let a=t.forwardRef((e,t)=>{let{asChild:a,...o}=e,l=a?n.Slot:r;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,s.jsx)(l,{...o,ref:t})});return a.displayName=`Primitive.${r}`,{...e,[r]:a}},{});function o(e,t){e&&r.flushSync(()=>e.dispatchEvent(t))}e.s(["Primitive",()=>a,"dispatchDiscreteCustomEvent",()=>o])},23750,e=>{"use strict";var t=e.i(62893),r=e.i(47163);function n({className:e,type:n,...s}){return(0,t.jsx)("input",{type:n,"data-slot":"input",className:(0,r.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",e),...s})}e.s(["Input",()=>n])},16752,e=>{"use strict";e.s(["brandColors",0,{950:"#052e16",900:"#14532d",800:"#166534",700:"#15803d",600:"#16a34a",500:"#22c55e",400:"#4ade80",300:"#86efac",200:"#bbf7d0",100:"#dcfce7",50:"#f0fdf4"},"creamColors",0,{900:"#8B7355",800:"#A08060",700:"#B8956B",600:"#C9A876",500:"#D4B896",400:"#E5D4B8",300:"#F0E6D6",200:"#F5EDE0",100:"#FAF7F2",50:"#FDFCFA"},"slateColors",0,{950:"#0f0f0f",900:"#1a1a1a",800:"#2d2d2d",700:"#404040",600:"#525252",500:"#6b6b6b",400:"#8a8a8a",300:"#b0b0b0",200:"#d4d4d4",100:"#ebebeb",50:"#f8f8f8"}])},74126,e=>{"use strict";var t=e.i(58846),r=e.i(11282),n=e.i(8372),s=e=>{var s;let o,l,{present:i,children:c}=e,u=function(e){var r,s;let[o,l]=t.useState(),i=t.useRef({}),c=t.useRef(e),u=t.useRef("none"),[d,f]=(r=e?"mounted":"unmounted",s={mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}},t.useReducer((e,t)=>s[e][t]??e,r));return t.useEffect(()=>{let e=a(i.current);u.current="mounted"===d?e:"none"},[d]),(0,n.useLayoutEffect)(()=>{let t=i.current,r=c.current;if(r!==e){let n=u.current,s=a(t);e?f("MOUNT"):"none"===s||t?.display==="none"?f("UNMOUNT"):r&&n!==s?f("ANIMATION_OUT"):f("UNMOUNT"),c.current=e}},[e,f]),(0,n.useLayoutEffect)(()=>{if(o){let e,t=o.ownerDocument.defaultView??window,r=r=>{let n=a(i.current).includes(r.animationName);if(r.target===o&&n&&(f("ANIMATION_END"),!c.current)){let r=o.style.animationFillMode;o.style.animationFillMode="forwards",e=t.setTimeout(()=>{"forwards"===o.style.animationFillMode&&(o.style.animationFillMode=r)})}},n=e=>{e.target===o&&(u.current=a(i.current))};return o.addEventListener("animationstart",n),o.addEventListener("animationcancel",r),o.addEventListener("animationend",r),()=>{t.clearTimeout(e),o.removeEventListener("animationstart",n),o.removeEventListener("animationcancel",r),o.removeEventListener("animationend",r)}}f("ANIMATION_END")},[o,f]),{isPresent:["mounted","unmountSuspended"].includes(d),ref:t.useCallback(e=>{e&&(i.current=getComputedStyle(e)),l(e)},[])}}(i),d="function"==typeof c?c({present:u.isPresent}):t.Children.only(c),f=(0,r.useComposedRefs)(u.ref,(s=d,(l=(o=Object.getOwnPropertyDescriptor(s.props,"ref")?.get)&&"isReactWarning"in o&&o.isReactWarning)?s.ref:(l=(o=Object.getOwnPropertyDescriptor(s,"ref")?.get)&&"isReactWarning"in o&&o.isReactWarning)?s.props.ref:s.props.ref||s.ref));return"function"==typeof c||u.isPresent?t.cloneElement(d,{ref:f}):null};function a(e){return e?.animationName||"none"}s.displayName="Presence",e.s(["Presence",()=>s])},78896,e=>{"use strict";function t(e,r,{checkForDefaultPrevented:n=!0}={}){return function(t){if(e?.(t),!1===n||!t.defaultPrevented)return r?.(t)}}e.s(["composeEventHandlers",()=>t])},17534,e=>{"use strict";var t=e.i(58846),r=e.i(62893);function n(e,n){let s=t.createContext(n),a=e=>{let{children:n,...a}=e,o=t.useMemo(()=>a,Object.values(a));return(0,r.jsx)(s.Provider,{value:o,children:n})};return a.displayName=e+"Provider",[a,function(r){let a=t.useContext(s);if(a)return a;if(void 0!==n)return n;throw Error(`\`${r}\` must be used within \`${e}\``)}]}function s(e,n=[]){let a=[],o=()=>{let r=a.map(e=>t.createContext(e));return function(n){let s=n?.[e]||r;return t.useMemo(()=>({[`__scope${e}`]:{...n,[e]:s}}),[n,s])}};return o.scopeName=e,[function(n,s){let o=t.createContext(s),l=a.length;a=[...a,s];let i=n=>{let{scope:s,children:a,...i}=n,c=s?.[e]?.[l]||o,u=t.useMemo(()=>i,Object.values(i));return(0,r.jsx)(c.Provider,{value:u,children:a})};return i.displayName=n+"Provider",[i,function(r,a){let i=a?.[e]?.[l]||o,c=t.useContext(i);if(c)return c;if(void 0!==s)return s;throw Error(`\`${r}\` must be used within \`${n}\``)}]},function(...e){let r=e[0];if(1===e.length)return r;let n=()=>{let n=e.map(e=>({useScope:e(),scopeName:e.scopeName}));return function(e){let s=n.reduce((t,{useScope:r,scopeName:n})=>{let s=r(e)[`__scope${n}`];return{...t,...s}},{});return t.useMemo(()=>({[`__scope${r.scopeName}`]:s}),[s])}};return n.scopeName=r.scopeName,n}(o,...n)]}e.s(["createContext",()=>n,"createContextScope",()=>s])},8372,e=>{"use strict";var t=e.i(58846),r=globalThis?.document?t.useLayoutEffect:()=>{};e.s(["useLayoutEffect",()=>r])},15981,e=>{"use strict";var t=e.i(58846);function r(e){let r=t.useRef(e);return t.useEffect(()=>{r.current=e}),t.useMemo(()=>(...e)=>r.current?.(...e),[])}e.s(["useCallbackRef",()=>r])},47946,71585,e=>{"use strict";var t=e.i(58846),r=e.i(8372),n=t["useId".toString()]||(()=>void 0),s=0;function a(e){let[a,o]=t.useState(n());return(0,r.useLayoutEffect)(()=>{e||o(e=>e??String(s++))},[e]),e||(a?`radix-${a}`:"")}e.s(["useId",()=>a],47946);var o=e.i(15981);function l({prop:e,defaultProp:r,onChange:n=()=>{}}){let[s,a]=function({defaultProp:e,onChange:r}){let n=t.useState(e),[s]=n,a=t.useRef(s),l=(0,o.useCallbackRef)(r);return t.useEffect(()=>{a.current!==s&&(l(s),a.current=s)},[s,a,l]),n}({defaultProp:r,onChange:n}),l=void 0!==e,i=l?e:s,c=(0,o.useCallbackRef)(n);return[i,t.useCallback(t=>{if(l){let r="function"==typeof t?t(e):t;r!==e&&c(r)}else a(t)},[l,e,a,c])]}e.s(["useControllableState",()=>l],71585)},46015,e=>{"use strict";let t=(0,e.i(10965).default)("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);e.s(["Smartphone",()=>t],46015)},64347,e=>{"use strict";let t=(0,e.i(10965).default)("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);e.s(["default",()=>t])},34853,e=>{"use strict";let t=(0,e.i(10965).default)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);e.s(["default",()=>t])},90864,e=>{"use strict";var t=e.i(64347);e.s(["ChevronDown",()=>t.default])},34290,e=>{"use strict";var t=e.i(34853);e.s(["X",()=>t.default])},75871,e=>{"use strict";e.i(30990);var t=e.i(62893),r=e.i(58846),n=e.i(14545),s=e.i(44727),a=e.i(40919),o=e.i(82396),l=e.i(12064),i=r,c=e.i(35274);function u(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}class d extends i.Component{getSnapshotBeforeUpdate(e){let t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){let e=t.offsetParent,r=(0,l.isHTMLElement)(e)&&e.offsetWidth||0,n=this.props.sizeRef.current;n.height=t.offsetHeight||0,n.width=t.offsetWidth||0,n.top=t.offsetTop,n.left=t.offsetLeft,n.right=r-n.width-n.left}return null}componentDidUpdate(){}render(){return this.props.children}}function f({children:e,isPresent:n,anchorX:s,root:a}){let o=(0,i.useId)(),l=(0,i.useRef)(null),f=(0,i.useRef)({width:0,height:0,top:0,left:0,right:0}),{nonce:m}=(0,i.useContext)(c.MotionConfigContext),p=function(...e){return r.useCallback(function(...e){return t=>{let r=!1,n=e.map(e=>{let n=u(e,t);return r||"function"!=typeof n||(r=!0),n});if(r)return()=>{for(let t=0;t<n.length;t++){let r=n[t];"function"==typeof r?r():u(e[t],null)}}}}(...e),e)}(l,e?.ref);return(0,i.useInsertionEffect)(()=>{let{width:e,height:t,top:r,left:i,right:c}=f.current;if(n||!l.current||!e||!t)return;let u="left"===s?`left: ${i}`:`right: ${c}`;l.current.dataset.motionPopId=o;let d=document.createElement("style");m&&(d.nonce=m);let p=a??document.head;return p.appendChild(d),d.sheet&&d.sheet.insertRule(`
          [data-motion-pop-id="${o}"] {
            position: absolute !important;
            width: ${e}px !important;
            height: ${t}px !important;
            ${u}px !important;
            top: ${r}px !important;
          }
        `),()=>{p.contains(d)&&p.removeChild(d)}},[n]),(0,t.jsx)(d,{isPresent:n,childRef:l,sizeRef:f,children:i.cloneElement(e,{ref:p})})}let m=({children:e,initial:n,isPresent:a,onExitComplete:l,custom:i,presenceAffectsLayout:c,mode:u,anchorX:d,root:m})=>{let h=(0,s.useConstant)(p),x=(0,r.useId)(),v=!0,y=(0,r.useMemo)(()=>(v=!1,{id:x,initial:n,isPresent:a,custom:i,onExitComplete:e=>{for(let t of(h.set(e,!0),h.values()))if(!t)return;l&&l()},register:e=>(h.set(e,!1),()=>h.delete(e))}),[a,h,l]);return c&&v&&(y={...y}),(0,r.useMemo)(()=>{h.forEach((e,t)=>h.set(t,!1))},[a]),r.useEffect(()=>{a||h.size||!l||l()},[a]),"popLayout"===u&&(e=(0,t.jsx)(f,{isPresent:a,anchorX:d,root:m,children:e})),(0,t.jsx)(o.PresenceContext.Provider,{value:y,children:e})};function p(){return new Map}var h=e.i(13671);let x=e=>e.key||"";function v(e){let t=[];return r.Children.forEach(e,e=>{(0,r.isValidElement)(e)&&t.push(e)}),t}let y=({children:e,custom:o,initial:l=!0,onExitComplete:i,presenceAffectsLayout:c=!0,mode:u="sync",propagate:d=!1,anchorX:f="left",root:p})=>{let[y,g]=(0,h.usePresence)(d),b=(0,r.useMemo)(()=>v(e),[e]),w=d&&!y?[]:b.map(x),k=(0,r.useRef)(!0),j=(0,r.useRef)(b),C=(0,s.useConstant)(()=>new Map),[N,E]=(0,r.useState)(b),[M,S]=(0,r.useState)(b);(0,a.useIsomorphicLayoutEffect)(()=>{k.current=!1,j.current=b;for(let e=0;e<M.length;e++){let t=x(M[e]);w.includes(t)?C.delete(t):!0!==C.get(t)&&C.set(t,!1)}},[M,w.length,w.join("-")]);let L=[];if(b!==N){let e=[...b];for(let t=0;t<M.length;t++){let r=M[t],n=x(r);w.includes(n)||(e.splice(t,0,r),L.push(r))}return"wait"===u&&L.length&&(e=L),S(v(e)),E(b),null}let{forceRender:T}=(0,r.useContext)(n.LayoutGroupContext);return(0,t.jsx)(t.Fragment,{children:M.map(e=>{let r=x(e),n=(!d||!!y)&&(b===M||w.includes(r));return(0,t.jsx)(m,{isPresent:n,initial:(!k.current||!!l)&&void 0,custom:o,presenceAffectsLayout:c,mode:u,root:p,onExitComplete:n?void 0:()=>{if(!C.has(r))return;C.set(r,!0);let e=!0;C.forEach(t=>{t||(e=!1)}),e&&(T?.(),S(j.current),d&&g?.(),i&&i())},anchorX:f,children:e},r)})})};e.s(["AnimatePresence",()=>y],75871)},25441,e=>{"use strict";let t=(0,e.i(10965).default)("GraduationCap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]);e.s(["GraduationCap",()=>t],25441)},68135,e=>{"use strict";let t=(0,e.i(10965).default)("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);e.s(["Home",()=>t],68135)},60313,e=>{"use strict";e.i(30990);var t=e.i(62893),r=e.i(70286),n=e.i(78824),s=e.i(58846),a=e.i(67881),o=e.i(68135),l=e.i(10965);let i=(0,l.default)("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),c=(0,l.default)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);var u=e.i(90864);let d=(0,l.default)("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);var f=e.i(34290);let m=(0,l.default)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),p=(0,l.default)("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),h=(0,l.default)("Coins",[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]]),x=(0,l.default)("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]),v=(0,l.default)("FilePen",[["path",{d:"M12.5 22H18a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v9.5",key:"1couwa"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M13.378 15.626a1 1 0 1 0-3.004-3.004l-5.01 5.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z",key:"1y4qbx"}]]);var y=e.i(25441),g=e.i(47163),b=e.i(78254);let w="#4CAF50",k="#2E7D32",j="#E8F5E9",C={50:"#FAFAFA",100:"#F5F5F5",200:"#EEEEEE",300:"#E0E0E0",400:"#BDBDBD",500:"#9E9E9E",600:"#757575",700:"#616161",800:"#424242",900:"#212121"},N="#E5E7EB",E=(0,b.createClient)("https://rnujdnmxufmzgjvmddla.supabase.co","sb_publishable_J6ZjOA1cvNVJE0msWjvJEA_Y3MHr9LH"),M="sidebar-collapse",S="credits-refresh";function L(){let e=(0,n.usePathname)(),l=(0,n.useSearchParams)();(0,n.useRouter)();let b=l.get("agent"),[L,T]=(0,s.useState)(null),[F,A]=(0,s.useState)(0),[P,R]=(0,s.useState)([]),[_,O]=(0,s.useState)(""),[I,D]=(0,s.useState)(!0),[$,z]=(0,s.useState)(!1),[U,B]=(0,s.useState)(!1),[H,q]=(0,s.useState)(!1),W=(0,s.useRef)(null),V=(0,s.useCallback)(async e=>{if(e)try{let t=await fetch(`/api/user/credits?user_id=${encodeURIComponent(e)}`);if(t.ok){let e=await t.json();A(e.credits||0),e.isNew}else{let r=await t.json().catch(()=>({}));console.error("❌ [侧边栏] 积分 API 返回错误:",t.status,r);let{data:n}=await E.from("user_credits").select("credits").eq("user_id",e).maybeSingle();n&&A(n.credits)}}catch(t){console.error("❌ [侧边栏] 积分查询异常:",t);try{let{data:t}=await E.from("user_credits").select("credits").eq("user_id",e).maybeSingle();t&&A(t.credits)}catch(e){console.error("❌ [侧边栏] 备用查询也失败:",e)}}},[]);(0,s.useEffect)(()=>{let e=()=>{let e=window.innerWidth<768;z(e),e?D(!1):D(!0)};e(),window.addEventListener("resize",e);let t=()=>{D(!1)};window.addEventListener(M,t);let r=()=>{{let e=localStorage.getItem("currentUser");if(e)try{let t=JSON.parse(e),r=t.id||t.sub||t.userId;r&&V(r)}catch(e){console.error(e)}}};window.addEventListener(S,r),(async()=>{let e="";{let t=localStorage.getItem("currentUser");if(t)try{let r=JSON.parse(t);T(r),e=r.id||r.sub||r.userId||r.user_id||"",O(e)}catch(e){console.error("❌ [侧边栏] 解析用户数据失败:",e)}}if(e){await V(e);let{data:t}=await E.from("chat_sessions").select("*").eq("user_id",e).order("created_at",{ascending:!1}).limit(10);t&&R(t.map(e=>({id:e.id,title:e.title||"新对话",date:new Date(e.created_at).getTime(),preview:e.preview||""})))}})();let n=e=>{W.current&&!W.current.contains(e.target)&&q(!1)};return document.addEventListener("mousedown",n),()=>{window.removeEventListener("resize",e),window.removeEventListener(M,t),window.removeEventListener(S,r),document.removeEventListener("mousedown",n)}},[V]),(0,s.useEffect)(()=>{_&&V(_)},[e,l,_,V]);let J=async()=>{await E.auth.signOut(),localStorage.removeItem("currentUser"),window.location.href="/login"},X=()=>{$&&D(!1)},G=()=>L?.user_metadata?.avatar_url||null,K=({href:e,icon:n,label:s,isActive:a,onClick:o})=>(0,t.jsxs)(r.default,{href:e,onClick:o||X,className:(0,g.cn)("relative flex items-center gap-3 px-3 py-3 text-sm font-medium transition-all","rounded-lg",a?"text-[#2E7D32]":"text-[#757575] hover:bg-[#F5F5F5] hover:text-[#616161]"),style:a?{backgroundColor:"rgba(76, 175, 80, 0.08)"}:{},children:[a&&(0,t.jsx)("div",{className:"absolute left-0 top-0 bottom-0 w-[3px] rounded-r-full",style:{backgroundColor:w}}),(0,t.jsx)(n,{className:(0,g.cn)("h-5 w-5 shrink-0",a?"text-[#2E7D32]":"text-[#757575]"),fill:a?"currentColor":"none",strokeWidth:2*!a}),(0,t.jsx)("span",{children:s})]});return(0,t.jsxs)(t.Fragment,{children:[$&&!I&&(0,t.jsx)("button",{onClick:()=>D(!0),className:"fixed left-4 top-4 z-50 flex h-10 w-10 items-center justify-center rounded-xl bg-white shadow-md text-[#757575] hover:bg-[#F5F5F5] transition-all",children:(0,t.jsx)(d,{className:"h-5 w-5"})}),$&&I&&(0,t.jsx)("div",{className:"fixed inset-0 z-30 bg-black/20 backdrop-blur-sm animate-in fade-in duration-200",onClick:()=>D(!1)}),(0,t.jsxs)("div",{className:(0,g.cn)("flex h-screen supports-[height:100dvh]:h-[100dvh] flex-col transition-all duration-300 ease-[cubic-bezier(0.32,0.72,0,1)] z-40","bg-white",$?(0,g.cn)("fixed left-0 top-0 bottom-0 w-72 shadow-xl",I?"translate-x-0":"-translate-x-full"):(0,g.cn)("sticky top-0 border-r",I?"w-64":"w-0 overflow-hidden")),style:{borderColor:N},children:[$&&(0,t.jsx)("button",{onClick:()=>D(!1),className:"absolute right-3 top-3 flex h-8 w-8 items-center justify-center rounded-lg text-[#9E9E9E] hover:text-[#616161] hover:bg-[#F5F5F5] transition-all z-50",children:(0,t.jsx)(f.X,{className:"h-5 w-5"})}),(0,t.jsx)("div",{className:"flex items-center h-16 shrink-0 px-5",children:(0,t.jsx)(r.default,{href:"/",onClick:X,className:"flex items-center gap-3",children:(0,t.jsx)("img",{src:"/images/logo.png",alt:"Logo",className:"h-12 w-auto object-contain"})})}),L&&(0,t.jsx)("div",{className:"px-4 mb-4",children:(0,t.jsxs)("div",{className:"flex items-center gap-2.5 px-4 py-2.5 rounded-xl",style:{backgroundColor:j,border:`1px solid ${w}20`},children:[(0,t.jsx)("div",{className:"flex h-8 w-8 items-center justify-center rounded-lg shadow-sm",style:{backgroundColor:w},children:(0,t.jsx)(h,{className:"h-4 w-4 text-white"})}),(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("span",{className:"text-lg font-bold",style:{color:k},children:F}),(0,t.jsx)("span",{className:"text-[10px] font-medium -mt-0.5",style:{color:`${w}99`},children:"积分余额"})]})]})}),(0,t.jsxs)("div",{className:"flex-1 overflow-y-auto overflow-x-hidden py-2 px-3 scrollbar-thin scrollbar-thumb-gray-200/50",children:[(0,t.jsx)(K,{href:"/",icon:o.Home,label:"主页",isActive:"/"===e}),(0,t.jsx)("div",{className:"mt-5 mb-3 px-3",children:(0,t.jsx)("span",{className:"text-[11px] font-semibold uppercase tracking-wider",style:{color:C[500]},children:"智能体"})}),(0,t.jsx)(K,{href:"/chat",icon:v,label:"作文批改",isActive:"/chat"===e&&!b}),(0,t.jsx)(K,{href:"/chat?agent=teaching-pro",icon:y.GraduationCap,label:"教学评助手",isActive:"teaching-pro"===b}),(0,t.jsx)("div",{className:"my-5 mx-3 h-px",style:{backgroundColor:N}}),P.length>0&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("button",{onClick:()=>B(!U),className:"mb-2 px-3 flex items-center gap-2 w-full text-left hover:opacity-80 transition-opacity",children:[(0,t.jsx)(x,{className:"h-4 w-4",style:{color:C[500]}}),(0,t.jsx)("span",{className:"text-[11px] font-semibold uppercase tracking-wider flex-1",style:{color:C[500]},children:"最近对话"}),(0,t.jsx)(u.ChevronDown,{className:(0,g.cn)("h-4 w-4 transition-transform duration-200",U&&"rotate-180"),style:{color:C[400]}})]}),(0,t.jsx)("div",{className:(0,g.cn)("space-y-0.5 overflow-hidden transition-all duration-300 ease-[cubic-bezier(0.32,0.72,0,1)]",U?"max-h-[400px] opacity-100":"max-h-0 opacity-0"),children:P.slice(0,6).map(e=>(0,t.jsxs)(r.default,{href:`/chat?id=${e.id}`,onClick:X,className:"block rounded-lg px-3 py-2.5 transition-all group",style:{backgroundColor:"transparent"},onMouseEnter:e=>e.currentTarget.style.backgroundColor=C[100],onMouseLeave:e=>e.currentTarget.style.backgroundColor="transparent",children:[(0,t.jsx)("div",{className:"text-[13px] font-medium truncate",style:{color:C[700]},children:e.title}),(0,t.jsx)("div",{className:"text-[11px] truncate mt-0.5",style:{color:C[500]},children:e.preview})]},e.id))})]})]}),(0,t.jsxs)("div",{className:"mt-auto shrink-0 p-3 bg-white z-50 relative",ref:W,style:{borderTop:`1px solid ${N}`},children:[H&&(0,t.jsxs)("div",{className:"absolute bottom-[calc(100%+8px)] left-3 right-3 rounded-xl bg-white p-1.5 shadow-lg animate-in slide-in-from-bottom-2 duration-200 z-[60]",style:{border:`1px solid ${C[200]}`},children:[(0,t.jsx)(r.default,{href:"/settings",onClick:()=>q(!1),children:(0,t.jsxs)("div",{className:"flex w-full items-center gap-3 rounded-lg px-3 py-2.5 text-sm cursor-pointer transition-colors",style:{color:C[700]},onMouseEnter:e=>e.currentTarget.style.backgroundColor=C[100],onMouseLeave:e=>e.currentTarget.style.backgroundColor="transparent",children:[(0,t.jsx)(i,{className:"h-5 w-5",style:{color:C[600]}}),"账号设置"]})}),(0,t.jsx)(r.default,{href:"/pricing",onClick:()=>q(!1),children:(0,t.jsxs)("div",{className:"flex w-full items-center gap-3 rounded-lg px-3 py-2.5 text-sm cursor-pointer transition-colors",style:{color:C[700]},onMouseEnter:e=>e.currentTarget.style.backgroundColor=C[100],onMouseLeave:e=>e.currentTarget.style.backgroundColor="transparent",children:[(0,t.jsx)(p,{className:"h-5 w-5",style:{color:C[600]}}),"升级会员"]})}),(0,t.jsx)("div",{className:"my-1 h-px mx-2",style:{backgroundColor:N}}),(0,t.jsxs)("button",{onClick:J,className:"flex w-full items-center gap-3 rounded-lg px-3 py-2.5 text-sm transition-colors group",style:{color:C[600]},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="#FEE2E2",e.currentTarget.style.color="#F44336"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="transparent",e.currentTarget.style.color=C[600]},children:[(0,t.jsx)(m,{className:"h-5 w-5"}),"退出登录"]})]}),L?(0,t.jsxs)("button",{type:"button",onClick:e=>{e.preventDefault(),e.stopPropagation(),q(!H)},className:(0,g.cn)("flex items-center w-full rounded-lg transition-all duration-200 overflow-hidden h-12 p-2 gap-3 cursor-pointer select-none"),style:{backgroundColor:H?C[100]:"transparent"},onMouseEnter:e=>{H||(e.currentTarget.style.backgroundColor=C[100])},onMouseLeave:e=>{H||(e.currentTarget.style.backgroundColor="transparent")},children:[(0,t.jsx)("div",{className:"flex h-8 w-8 shrink-0 items-center justify-center rounded-full text-white text-sm font-bold overflow-hidden shadow-sm pointer-events-none",style:{backgroundColor:w},children:G()?(0,t.jsx)("img",{src:G(),alt:"User",className:"h-full w-full object-cover"}):L.email?.[0]?.toUpperCase()||"U"}),(0,t.jsx)("div",{className:"flex flex-1 flex-col items-start overflow-hidden pointer-events-none min-w-0",children:(0,t.jsx)("span",{className:"text-sm font-medium w-full text-left truncate",style:{color:C[700],textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"},children:L?L.phone?L.phone:L.email?L.email:L.user_metadata?.name?L.user_metadata.name:"用户":"用户"})}),(0,t.jsx)(c,{className:(0,g.cn)("h-4 w-4 transition-transform duration-200 pointer-events-none shrink-0",H&&"rotate-90"),style:{color:C[400]}})]}):(0,t.jsx)(r.default,{href:"/login",onClick:X,children:(0,t.jsx)(a.Button,{className:"w-full text-white font-semibold rounded-lg h-11",style:{backgroundColor:w,boxShadow:`0 4px 12px ${w}40`},children:"登录 / 注册"})})]})]})]})}function T(){return(0,t.jsx)(s.Suspense,{fallback:(0,t.jsx)("div",{className:"w-64 h-screen bg-white border-r border-gray-200"}),children:(0,t.jsx)(L,{})})}e.s(["AppSidebar",()=>T,"collapseSidebar",0,()=>{window.dispatchEvent(new CustomEvent(M))},"refreshCredits",0,()=>{window.dispatchEvent(new CustomEvent(S))}],60313)}]);