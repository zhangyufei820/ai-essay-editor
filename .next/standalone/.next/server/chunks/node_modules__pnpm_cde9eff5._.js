module.exports=[44704,(e,t,r)=>{"use strict";let a="undefined"!=typeof Buffer,n=/"(?:_|\\u005[Ff])(?:_|\\u005[Ff])(?:p|\\u0070)(?:r|\\u0072)(?:o|\\u006[Ff])(?:t|\\u0074)(?:o|\\u006[Ff])(?:_|\\u005[Ff])(?:_|\\u005[Ff])"\s*:/,s=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/;function i(e,t,r){null==r&&null!==t&&"object"==typeof t&&(r=t,t=void 0),a&&Buffer.isBuffer(e)&&(e=e.toString()),e&&65279===e.charCodeAt(0)&&(e=e.slice(1));let i=JSON.parse(e,t);if(null===i||"object"!=typeof i)return i;let l=r&&r.protoAction||"error",u=r&&r.constructorAction||"error";if("ignore"===l&&"ignore"===u)return i;if("ignore"!==l&&"ignore"!==u){if(!1===n.test(e)&&!1===s.test(e))return i}else if("ignore"!==l&&"ignore"===u){if(!1===n.test(e))return i}else if(!1===s.test(e))return i;return o(i,{protoAction:l,constructorAction:u,safe:r&&r.safe})}function o(e,{protoAction:t="error",constructorAction:r="error",safe:a}={}){let n=[e];for(;n.length;){let e=n;for(let s of(n=[],e)){if("ignore"!==t&&Object.prototype.hasOwnProperty.call(s,"__proto__")){if(!0===a)return null;if("error"===t)throw SyntaxError("Object contains forbidden prototype property");delete s.__proto__}if("ignore"!==r&&Object.prototype.hasOwnProperty.call(s,"constructor")&&Object.prototype.hasOwnProperty.call(s.constructor,"prototype")){if(!0===a)return null;if("error"===r)throw SyntaxError("Object contains forbidden prototype property");delete s.constructor}for(let e in s){let t=s[e];t&&"object"==typeof t&&n.push(t)}}}return e}function l(e,t,r){let a=Error.stackTraceLimit;Error.stackTraceLimit=0;try{return i(e,t,r)}finally{Error.stackTraceLimit=a}}t.exports=l,t.exports.default=l,t.exports.parse=l,t.exports.safeParse=function(e,t){let r=Error.stackTraceLimit;Error.stackTraceLimit=0;try{return i(e,t,{safe:!0})}catch(e){return null}finally{Error.stackTraceLimit=r}},t.exports.scan=o},65209,e=>{"use strict";let t,r;var a,n,s,i,o,l,u,d,c,p,m,h,f,y,g,v,_,b,x,k,w,T,S,Z,A="vercel.ai.error",I=Symbol.for(A),N=class e extends Error{constructor({name:e,message:t,cause:r}){super(t),this[i]=!0,this.name=e,this.cause=r}static isInstance(t){return e.hasMarker(t,A)}static hasMarker(e,t){let r=Symbol.for(t);return null!=e&&"object"==typeof e&&r in e&&"boolean"==typeof e[r]&&!0===e[r]}};i=I;var j=N,O="AI_APICallError",E=`vercel.ai.error.${O}`,P=Symbol.for(E),C=class extends j{constructor({message:e,url:t,requestBodyValues:r,statusCode:a,responseHeaders:n,responseBody:s,cause:i,isRetryable:l=null!=a&&(408===a||409===a||429===a||a>=500),data:u}){super({name:O,message:e,cause:i}),this[o]=!0,this.url=t,this.requestBodyValues=r,this.statusCode=a,this.responseHeaders=n,this.responseBody=s,this.isRetryable=l,this.data=u}static isInstance(e){return j.hasMarker(e,E)}};function R(e){return null==e?"unknown error":"string"==typeof e?e:e instanceof Error?e.message:JSON.stringify(e)}o=P,Symbol.for("vercel.ai.error.AI_EmptyResponseBodyError");var $="AI_InvalidArgumentError",M=`vercel.ai.error.${$}`,L=Symbol.for(M),F=class extends j{constructor({message:e,cause:t,argument:r}){super({name:$,message:e,cause:t}),this[l]=!0,this.argument=r}static isInstance(e){return j.hasMarker(e,M)}};l=L;var z="AI_InvalidPromptError",U=`vercel.ai.error.${z}`,D=Symbol.for(U),V=class extends j{constructor({prompt:e,message:t,cause:r}){super({name:z,message:`Invalid prompt: ${t}`,cause:r}),this[u]=!0,this.prompt=e}static isInstance(e){return j.hasMarker(e,U)}};u=D,Symbol.for("vercel.ai.error.AI_InvalidResponseDataError");var q="AI_JSONParseError",B=`vercel.ai.error.${q}`,K=Symbol.for(B),J=class extends j{constructor({text:e,cause:t}){super({name:q,message:`JSON parsing failed: Text: ${e}.
Error message: ${R(t)}`,cause:t}),this[d]=!0,this.text=e}static isInstance(e){return j.hasMarker(e,B)}};d=K,Symbol.for("vercel.ai.error.AI_LoadAPIKeyError"),Symbol.for("vercel.ai.error.AI_LoadSettingError"),Symbol.for("vercel.ai.error.AI_NoContentGeneratedError"),Symbol.for("vercel.ai.error.AI_NoSuchModelError"),Symbol.for("vercel.ai.error.AI_TooManyEmbeddingValuesForCallError");var W="AI_TypeValidationError",Y=`vercel.ai.error.${W}`,H=Symbol.for(Y),G=class e extends j{constructor({value:e,cause:t}){super({name:W,message:`Type validation failed: Value: ${JSON.stringify(e)}.
Error message: ${R(t)}`,cause:t}),this[c]=!0,this.value=e}static isInstance(e){return j.hasMarker(e,Y)}static wrap({value:t,cause:r}){return e.isInstance(r)&&r.value===t?r:new e({value:t,cause:r})}};c=H;Symbol.for("vercel.ai.error.AI_UnsupportedFunctionalityError");var X=e.i(44704);TransformStream;var Q=({prefix:e,size:t=16,alphabet:r="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",separator:a="-"}={})=>{let n=((e,t=21)=>(r=t)=>{let a="",n=0|r;for(;n--;)a+=e[Math.random()*e.length|0];return a})(r,t);if(null==e)return n;if(r.includes(a))throw new F({argument:"separator",message:`The separator "${a}" must not be part of the alphabet "${r}".`});return t=>`${e}${a}${n(t)}`};Q();var ee=Symbol.for("vercel.ai.validator");function et({value:e,schema:t}){var r;let a="object"==typeof t&&null!==t&&ee in t&&!0===t[ee]&&"validate"in t?t:(r=t,{[ee]:!0,validate:e=>{let t=r.safeParse(e);return t.success?{success:!0,value:t.data}:{success:!1,error:t.error}}});try{if(null==a.validate)return{success:!0,value:e};let t=a.validate(e);if(t.success)return t;return{success:!1,error:G.wrap({value:e,cause:t.error})}}catch(t){return{success:!1,error:G.wrap({value:e,cause:t})}}}function er({text:e,schema:t}){try{let r=X.default.parse(e);if(null==t)return{success:!0,value:r};return et({value:r,schema:t})}catch(t){return{success:!1,error:J.isInstance(t)?t:new J({text:e,cause:t})}}}var{btoa:ea,atob:en}=globalThis;function es(e){let t="";for(let r=0;r<e.length;r++)t+=String.fromCodePoint(e[r]);return ea(t)}let ei=Symbol("Let zodToJsonSchema decide on which parser to use"),eo={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",allowedAdditionalProperties:!0,rejectedAdditionalProperties:!1,definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref",openAiAnyTypeName:"OpenAiAnyType"};function el(e,t,r,a){a?.errorMessages&&r&&(e.errorMessage={...e.errorMessage,[t]:r})}function eu(e,t,r,a,n){e[t]=r,el(e,t,a,n)}let ed=(e,t)=>{let r=0;for(;r<e.length&&r<t.length&&e[r]===t[r];r++);return[(e.length-r).toString(),...t.slice(r)].join("/")};(a=p||(p={})).assertEqual=e=>{},a.assertIs=function(e){},a.assertNever=function(e){throw Error()},a.arrayToEnum=e=>{let t={};for(let r of e)t[r]=r;return t},a.getValidEnumValues=e=>{let t=a.objectKeys(e).filter(t=>"number"!=typeof e[e[t]]),r={};for(let a of t)r[a]=e[a];return a.objectValues(r)},a.objectValues=e=>a.objectKeys(e).map(function(t){return e[t]}),a.objectKeys="function"==typeof Object.keys?e=>Object.keys(e):e=>{let t=[];for(let r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.push(r);return t},a.find=(e,t)=>{for(let r of e)if(t(r))return r},a.isInteger="function"==typeof Number.isInteger?e=>Number.isInteger(e):e=>"number"==typeof e&&Number.isFinite(e)&&Math.floor(e)===e,a.joinValues=function(e,t=" | "){return e.map(e=>"string"==typeof e?`'${e}'`:e).join(t)},a.jsonStringifyReplacer=(e,t)=>"bigint"==typeof t?t.toString():t,(m||(m={})).mergeShapes=(e,t)=>({...e,...t});let ec=p.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),ep=e=>{switch(typeof e){case"undefined":return ec.undefined;case"string":return ec.string;case"number":return Number.isNaN(e)?ec.nan:ec.number;case"boolean":return ec.boolean;case"function":return ec.function;case"bigint":return ec.bigint;case"symbol":return ec.symbol;case"object":if(Array.isArray(e))return ec.array;if(null===e)return ec.null;if(e.then&&"function"==typeof e.then&&e.catch&&"function"==typeof e.catch)return ec.promise;if("undefined"!=typeof Map&&e instanceof Map)return ec.map;if("undefined"!=typeof Set&&e instanceof Set)return ec.set;if("undefined"!=typeof Date&&e instanceof Date)return ec.date;return ec.object;default:return ec.unknown}};e.s(["ZodParsedType",0,ec,"getParsedType",0,ep,"objectUtil",()=>m,"util",()=>p],16013);let em=p.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),eh=e=>JSON.stringify(e,null,2).replace(/"([^"]+)":/g,"$1:");class ef extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=e=>{this.issues=[...this.issues,e]},this.addIssues=(e=[])=>{this.issues=[...this.issues,...e]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}format(e){let t=e||function(e){return e.message},r={_errors:[]},a=e=>{for(let n of e.issues)if("invalid_union"===n.code)n.unionErrors.map(a);else if("invalid_return_type"===n.code)a(n.returnTypeError);else if("invalid_arguments"===n.code)a(n.argumentsError);else if(0===n.path.length)r._errors.push(t(n));else{let e=r,a=0;for(;a<n.path.length;){let r=n.path[a];a===n.path.length-1?(e[r]=e[r]||{_errors:[]},e[r]._errors.push(t(n))):e[r]=e[r]||{_errors:[]},e=e[r],a++}}};return a(this),r}static assert(e){if(!(e instanceof ef))throw Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,p.jsonStringifyReplacer,2)}get isEmpty(){return 0===this.issues.length}flatten(e=e=>e.message){let t={},r=[];for(let a of this.issues)if(a.path.length>0){let r=a.path[0];t[r]=t[r]||[],t[r].push(e(a))}else r.push(e(a));return{formErrors:r,fieldErrors:t}}get formErrors(){return this.flatten()}}ef.create=e=>new ef(e),e.s(["ZodError",()=>ef,"ZodIssueCode",0,em,"quotelessJson",0,eh],32218);let ey=(e,t)=>{let r;switch(e.code){case em.invalid_type:r=e.received===ec.undefined?"Required":`Expected ${e.expected}, received ${e.received}`;break;case em.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(e.expected,p.jsonStringifyReplacer)}`;break;case em.unrecognized_keys:r=`Unrecognized key(s) in object: ${p.joinValues(e.keys,", ")}`;break;case em.invalid_union:r="Invalid input";break;case em.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${p.joinValues(e.options)}`;break;case em.invalid_enum_value:r=`Invalid enum value. Expected ${p.joinValues(e.options)}, received '${e.received}'`;break;case em.invalid_arguments:r="Invalid function arguments";break;case em.invalid_return_type:r="Invalid function return type";break;case em.invalid_date:r="Invalid date";break;case em.invalid_string:"object"==typeof e.validation?"includes"in e.validation?(r=`Invalid input: must include "${e.validation.includes}"`,"number"==typeof e.validation.position&&(r=`${r} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?r=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?r=`Invalid input: must end with "${e.validation.endsWith}"`:p.assertNever(e.validation):r="regex"!==e.validation?`Invalid ${e.validation}`:"Invalid";break;case em.too_small:r="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:"number"===e.type||"bigint"===e.type?`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:"date"===e.type?`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:"Invalid input";break;case em.too_big:r="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"bigint"===e.type?`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"date"===e.type?`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:"Invalid input";break;case em.custom:r="Invalid input";break;case em.invalid_intersection_types:r="Intersection results could not be merged";break;case em.not_multiple_of:r=`Number must be a multiple of ${e.multipleOf}`;break;case em.not_finite:r="Number must be finite";break;default:r=t.defaultError,p.assertNever(e)}return{message:r}},eg=ey;function ev(e){eg=e}function e_(){return eg}e.s(["getErrorMap",()=>e_,"setErrorMap",()=>ev],13297),(n=h||(h={})).errToObj=e=>"string"==typeof e?{message:e}:e||{},n.toString=e=>"string"==typeof e?e:e?.message;let eb=e=>{let{data:t,path:r,errorMaps:a,issueData:n}=e,s=[...r,...n.path||[]],i={...n,path:s};if(void 0!==n.message)return{...n,path:s,message:n.message};let o="";for(let e of a.filter(e=>!!e).slice().reverse())o=e(i,{data:t,defaultError:o}).message;return{...n,path:s,message:o}},ex=[];function ek(e,t){let r=eg,a=eb({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,r,r===ey?void 0:ey].filter(e=>!!e)});e.common.issues.push(a)}class ew{constructor(){this.value="valid"}dirty(){"valid"===this.value&&(this.value="dirty")}abort(){"aborted"!==this.value&&(this.value="aborted")}static mergeArray(e,t){let r=[];for(let a of t){if("aborted"===a.status)return eT;"dirty"===a.status&&e.dirty(),r.push(a.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,t){let r=[];for(let e of t){let t=await e.key,a=await e.value;r.push({key:t,value:a})}return ew.mergeObjectSync(e,r)}static mergeObjectSync(e,t){let r={};for(let a of t){let{key:t,value:n}=a;if("aborted"===t.status||"aborted"===n.status)return eT;"dirty"===t.status&&e.dirty(),"dirty"===n.status&&e.dirty(),"__proto__"!==t.value&&(void 0!==n.value||a.alwaysSet)&&(r[t.value]=n.value)}return{status:e.value,value:r}}}let eT=Object.freeze({status:"aborted"}),eS=e=>({status:"dirty",value:e}),eZ=e=>({status:"valid",value:e}),eA=e=>"aborted"===e.status,eI=e=>"dirty"===e.status,eN=e=>"valid"===e.status,ej=e=>"undefined"!=typeof Promise&&e instanceof Promise;e.s(["DIRTY",0,eS,"EMPTY_PATH",0,ex,"INVALID",0,eT,"OK",0,eZ,"ParseStatus",()=>ew,"addIssueToContext",()=>ek,"isAborted",0,eA,"isAsync",0,ej,"isDirty",0,eI,"isValid",0,eN,"makeIssue",0,eb],6686);class eO{constructor(e,t,r,a){this._cachedPath=[],this.parent=e,this.data=t,this._path=r,this._key=a}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}let eE=(e,t)=>{if(eN(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let t=new ef(e.common.issues);return this._error=t,this._error}}};function eP(e){if(!e)return{};let{errorMap:t,invalid_type_error:r,required_error:a,description:n}=e;if(t&&(r||a))throw Error('Can\'t use "invalid_type_error" or "required_error" in conjunction with custom error map.');return t?{errorMap:t,description:n}:{errorMap:(t,n)=>{let{message:s}=e;return"invalid_enum_value"===t.code?{message:s??n.defaultError}:void 0===n.data?{message:s??a??n.defaultError}:"invalid_type"!==t.code?{message:n.defaultError}:{message:s??r??n.defaultError}},description:n}}class eC{get description(){return this._def.description}_getType(e){return ep(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:ep(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new ew,ctx:{common:e.parent.common,data:e.data,parsedType:ep(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let t=this._parse(e);if(ej(t))throw Error("Synchronous parse encountered promise.");return t}_parseAsync(e){return Promise.resolve(this._parse(e))}parse(e,t){let r=this.safeParse(e,t);if(r.success)return r.data;throw r.error}safeParse(e,t){let r={common:{issues:[],async:t?.async??!1,contextualErrorMap:t?.errorMap},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ep(e)},a=this._parseSync({data:e,path:r.path,parent:r});return eE(r,a)}"~validate"(e){let t={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ep(e)};if(!this["~standard"].async)try{let r=this._parseSync({data:e,path:[],parent:t});return eN(r)?{value:r.value}:{issues:t.common.issues}}catch(e){e?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),t.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:t}).then(e=>eN(e)?{value:e.value}:{issues:t.common.issues})}async parseAsync(e,t){let r=await this.safeParseAsync(e,t);if(r.success)return r.data;throw r.error}async safeParseAsync(e,t){let r={common:{issues:[],contextualErrorMap:t?.errorMap,async:!0},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ep(e)},a=this._parse({data:e,path:r.path,parent:r});return eE(r,await (ej(a)?a:Promise.resolve(a)))}refine(e,t){return this._refinement((r,a)=>{let n=e(r),s=()=>a.addIssue({code:em.custom,..."string"==typeof t||void 0===t?{message:t}:"function"==typeof t?t(r):t});return"undefined"!=typeof Promise&&n instanceof Promise?n.then(e=>!!e||(s(),!1)):!!n||(s(),!1)})}refinement(e,t){return this._refinement((r,a)=>!!e(r)||(a.addIssue("function"==typeof t?t(r,a):t),!1))}_refinement(e){return new tv({schema:this,typeName:f.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:e=>this["~validate"](e)}}optional(){return t_.create(this,this._def)}nullable(){return tb.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return tt.create(this)}promise(){return tg.create(this,this._def)}or(e){return ta.create([this,e],this._def)}and(e){return ti.create(this,e,this._def)}transform(e){return new tv({...eP(this._def),schema:this,typeName:f.ZodEffects,effect:{type:"transform",transform:e}})}default(e){return new tx({...eP(this._def),innerType:this,defaultValue:"function"==typeof e?e:()=>e,typeName:f.ZodDefault})}brand(){return new tS({typeName:f.ZodBranded,type:this,...eP(this._def)})}catch(e){return new tk({...eP(this._def),innerType:this,catchValue:"function"==typeof e?e:()=>e,typeName:f.ZodCatch})}describe(e){return new this.constructor({...this._def,description:e})}pipe(e){return tZ.create(this,e)}readonly(){return tA.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}let eR=/^c[^\s-]{8,}$/i,e$=/^[0-9a-z]+$/,eM=/^[0-9A-HJKMNP-TV-Z]{26}$/i,eL=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,eF=/^[a-z0-9_-]{21}$/i,ez=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,eU=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,eD=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,eV=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,eq=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,eB=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,eK=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,eJ=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,eW=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,eY="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",eH=RegExp(`^${eY}$`);function eG(e){let t="[0-5]\\d";e.precision?t=`${t}\\.\\d{${e.precision}}`:null==e.precision&&(t=`${t}(\\.\\d+)?`);let r=e.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${t})${r}`}function eX(e){let t=`${eY}T${eG(e)}`,r=[];return r.push(e.local?"Z?":"Z"),e.offset&&r.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${r.join("|")})`,RegExp(`^${t}$`)}class eQ extends eC{_parse(e){var r,a,n,s;let i;if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==ec.string){let t=this._getOrReturnCtx(e);return ek(t,{code:em.invalid_type,expected:ec.string,received:t.parsedType}),eT}let o=new ew;for(let l of this._def.checks)if("min"===l.kind)e.data.length<l.value&&(ek(i=this._getOrReturnCtx(e,i),{code:em.too_small,minimum:l.value,type:"string",inclusive:!0,exact:!1,message:l.message}),o.dirty());else if("max"===l.kind)e.data.length>l.value&&(ek(i=this._getOrReturnCtx(e,i),{code:em.too_big,maximum:l.value,type:"string",inclusive:!0,exact:!1,message:l.message}),o.dirty());else if("length"===l.kind){let t=e.data.length>l.value,r=e.data.length<l.value;(t||r)&&(i=this._getOrReturnCtx(e,i),t?ek(i,{code:em.too_big,maximum:l.value,type:"string",inclusive:!0,exact:!0,message:l.message}):r&&ek(i,{code:em.too_small,minimum:l.value,type:"string",inclusive:!0,exact:!0,message:l.message}),o.dirty())}else if("email"===l.kind)eD.test(e.data)||(ek(i=this._getOrReturnCtx(e,i),{validation:"email",code:em.invalid_string,message:l.message}),o.dirty());else if("emoji"===l.kind)t||(t=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),t.test(e.data)||(ek(i=this._getOrReturnCtx(e,i),{validation:"emoji",code:em.invalid_string,message:l.message}),o.dirty());else if("uuid"===l.kind)eL.test(e.data)||(ek(i=this._getOrReturnCtx(e,i),{validation:"uuid",code:em.invalid_string,message:l.message}),o.dirty());else if("nanoid"===l.kind)eF.test(e.data)||(ek(i=this._getOrReturnCtx(e,i),{validation:"nanoid",code:em.invalid_string,message:l.message}),o.dirty());else if("cuid"===l.kind)eR.test(e.data)||(ek(i=this._getOrReturnCtx(e,i),{validation:"cuid",code:em.invalid_string,message:l.message}),o.dirty());else if("cuid2"===l.kind)e$.test(e.data)||(ek(i=this._getOrReturnCtx(e,i),{validation:"cuid2",code:em.invalid_string,message:l.message}),o.dirty());else if("ulid"===l.kind)eM.test(e.data)||(ek(i=this._getOrReturnCtx(e,i),{validation:"ulid",code:em.invalid_string,message:l.message}),o.dirty());else if("url"===l.kind)try{new URL(e.data)}catch{ek(i=this._getOrReturnCtx(e,i),{validation:"url",code:em.invalid_string,message:l.message}),o.dirty()}else"regex"===l.kind?(l.regex.lastIndex=0,l.regex.test(e.data)||(ek(i=this._getOrReturnCtx(e,i),{validation:"regex",code:em.invalid_string,message:l.message}),o.dirty())):"trim"===l.kind?e.data=e.data.trim():"includes"===l.kind?e.data.includes(l.value,l.position)||(ek(i=this._getOrReturnCtx(e,i),{code:em.invalid_string,validation:{includes:l.value,position:l.position},message:l.message}),o.dirty()):"toLowerCase"===l.kind?e.data=e.data.toLowerCase():"toUpperCase"===l.kind?e.data=e.data.toUpperCase():"startsWith"===l.kind?e.data.startsWith(l.value)||(ek(i=this._getOrReturnCtx(e,i),{code:em.invalid_string,validation:{startsWith:l.value},message:l.message}),o.dirty()):"endsWith"===l.kind?e.data.endsWith(l.value)||(ek(i=this._getOrReturnCtx(e,i),{code:em.invalid_string,validation:{endsWith:l.value},message:l.message}),o.dirty()):"datetime"===l.kind?eX(l).test(e.data)||(ek(i=this._getOrReturnCtx(e,i),{code:em.invalid_string,validation:"datetime",message:l.message}),o.dirty()):"date"===l.kind?eH.test(e.data)||(ek(i=this._getOrReturnCtx(e,i),{code:em.invalid_string,validation:"date",message:l.message}),o.dirty()):"time"===l.kind?RegExp(`^${eG(l)}$`).test(e.data)||(ek(i=this._getOrReturnCtx(e,i),{code:em.invalid_string,validation:"time",message:l.message}),o.dirty()):"duration"===l.kind?eU.test(e.data)||(ek(i=this._getOrReturnCtx(e,i),{validation:"duration",code:em.invalid_string,message:l.message}),o.dirty()):"ip"===l.kind?(r=e.data,!(("v4"===(a=l.version)||!a)&&eV.test(r)||("v6"===a||!a)&&eB.test(r))&&1&&(ek(i=this._getOrReturnCtx(e,i),{validation:"ip",code:em.invalid_string,message:l.message}),o.dirty())):"jwt"===l.kind?!function(e,t){if(!ez.test(e))return!1;try{let[r]=e.split(".");if(!r)return!1;let a=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),n=JSON.parse(atob(a));if("object"!=typeof n||null===n||"typ"in n&&n?.typ!=="JWT"||!n.alg||t&&n.alg!==t)return!1;return!0}catch{return!1}}(e.data,l.alg)&&(ek(i=this._getOrReturnCtx(e,i),{validation:"jwt",code:em.invalid_string,message:l.message}),o.dirty()):"cidr"===l.kind?(n=e.data,!(("v4"===(s=l.version)||!s)&&eq.test(n)||("v6"===s||!s)&&eK.test(n))&&1&&(ek(i=this._getOrReturnCtx(e,i),{validation:"cidr",code:em.invalid_string,message:l.message}),o.dirty())):"base64"===l.kind?eJ.test(e.data)||(ek(i=this._getOrReturnCtx(e,i),{validation:"base64",code:em.invalid_string,message:l.message}),o.dirty()):"base64url"===l.kind?eW.test(e.data)||(ek(i=this._getOrReturnCtx(e,i),{validation:"base64url",code:em.invalid_string,message:l.message}),o.dirty()):p.assertNever(l);return{status:o.value,value:e.data}}_regex(e,t,r){return this.refinement(t=>e.test(t),{validation:t,code:em.invalid_string,...h.errToObj(r)})}_addCheck(e){return new eQ({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...h.errToObj(e)})}url(e){return this._addCheck({kind:"url",...h.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...h.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...h.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...h.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...h.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...h.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...h.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...h.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...h.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...h.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...h.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...h.errToObj(e)})}datetime(e){return"string"==typeof e?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:void 0===e?.precision?null:e?.precision,offset:e?.offset??!1,local:e?.local??!1,...h.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return"string"==typeof e?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:void 0===e?.precision?null:e?.precision,...h.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...h.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...h.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t?.position,...h.errToObj(t?.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...h.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...h.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...h.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...h.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...h.errToObj(t)})}nonempty(e){return this.min(1,h.errToObj(e))}trim(){return new eQ({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new eQ({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new eQ({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>"datetime"===e.kind)}get isDate(){return!!this._def.checks.find(e=>"date"===e.kind)}get isTime(){return!!this._def.checks.find(e=>"time"===e.kind)}get isDuration(){return!!this._def.checks.find(e=>"duration"===e.kind)}get isEmail(){return!!this._def.checks.find(e=>"email"===e.kind)}get isURL(){return!!this._def.checks.find(e=>"url"===e.kind)}get isEmoji(){return!!this._def.checks.find(e=>"emoji"===e.kind)}get isUUID(){return!!this._def.checks.find(e=>"uuid"===e.kind)}get isNANOID(){return!!this._def.checks.find(e=>"nanoid"===e.kind)}get isCUID(){return!!this._def.checks.find(e=>"cuid"===e.kind)}get isCUID2(){return!!this._def.checks.find(e=>"cuid2"===e.kind)}get isULID(){return!!this._def.checks.find(e=>"ulid"===e.kind)}get isIP(){return!!this._def.checks.find(e=>"ip"===e.kind)}get isCIDR(){return!!this._def.checks.find(e=>"cidr"===e.kind)}get isBase64(){return!!this._def.checks.find(e=>"base64"===e.kind)}get isBase64url(){return!!this._def.checks.find(e=>"base64url"===e.kind)}get minLength(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}eQ.create=e=>new eQ({checks:[],typeName:f.ZodString,coerce:e?.coerce??!1,...eP(e)});class e0 extends eC{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){let t;if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==ec.number){let t=this._getOrReturnCtx(e);return ek(t,{code:em.invalid_type,expected:ec.number,received:t.parsedType}),eT}let r=new ew;for(let a of this._def.checks)"int"===a.kind?p.isInteger(e.data)||(ek(t=this._getOrReturnCtx(e,t),{code:em.invalid_type,expected:"integer",received:"float",message:a.message}),r.dirty()):"min"===a.kind?(a.inclusive?e.data<a.value:e.data<=a.value)&&(ek(t=this._getOrReturnCtx(e,t),{code:em.too_small,minimum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),r.dirty()):"max"===a.kind?(a.inclusive?e.data>a.value:e.data>=a.value)&&(ek(t=this._getOrReturnCtx(e,t),{code:em.too_big,maximum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),r.dirty()):"multipleOf"===a.kind?0!==function(e,t){let r=(e.toString().split(".")[1]||"").length,a=(t.toString().split(".")[1]||"").length,n=r>a?r:a;return Number.parseInt(e.toFixed(n).replace(".",""))%Number.parseInt(t.toFixed(n).replace(".",""))/10**n}(e.data,a.value)&&(ek(t=this._getOrReturnCtx(e,t),{code:em.not_multiple_of,multipleOf:a.value,message:a.message}),r.dirty()):"finite"===a.kind?Number.isFinite(e.data)||(ek(t=this._getOrReturnCtx(e,t),{code:em.not_finite,message:a.message}),r.dirty()):p.assertNever(a);return{status:r.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,h.toString(t))}gt(e,t){return this.setLimit("min",e,!1,h.toString(t))}lte(e,t){return this.setLimit("max",e,!0,h.toString(t))}lt(e,t){return this.setLimit("max",e,!1,h.toString(t))}setLimit(e,t,r,a){return new e0({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:h.toString(a)}]})}_addCheck(e){return new e0({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:h.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:h.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:h.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:h.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:h.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:h.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:h.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:h.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:h.toString(e)})}get minValue(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>"int"===e.kind||"multipleOf"===e.kind&&p.isInteger(e.value))}get isFinite(){let e=null,t=null;for(let r of this._def.checks)if("finite"===r.kind||"int"===r.kind||"multipleOf"===r.kind)return!0;else"min"===r.kind?(null===t||r.value>t)&&(t=r.value):"max"===r.kind&&(null===e||r.value<e)&&(e=r.value);return Number.isFinite(t)&&Number.isFinite(e)}}e0.create=e=>new e0({checks:[],typeName:f.ZodNumber,coerce:e?.coerce||!1,...eP(e)});class e1 extends eC{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){let t;if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==ec.bigint)return this._getInvalidInput(e);let r=new ew;for(let a of this._def.checks)"min"===a.kind?(a.inclusive?e.data<a.value:e.data<=a.value)&&(ek(t=this._getOrReturnCtx(e,t),{code:em.too_small,type:"bigint",minimum:a.value,inclusive:a.inclusive,message:a.message}),r.dirty()):"max"===a.kind?(a.inclusive?e.data>a.value:e.data>=a.value)&&(ek(t=this._getOrReturnCtx(e,t),{code:em.too_big,type:"bigint",maximum:a.value,inclusive:a.inclusive,message:a.message}),r.dirty()):"multipleOf"===a.kind?e.data%a.value!==BigInt(0)&&(ek(t=this._getOrReturnCtx(e,t),{code:em.not_multiple_of,multipleOf:a.value,message:a.message}),r.dirty()):p.assertNever(a);return{status:r.value,value:e.data}}_getInvalidInput(e){let t=this._getOrReturnCtx(e);return ek(t,{code:em.invalid_type,expected:ec.bigint,received:t.parsedType}),eT}gte(e,t){return this.setLimit("min",e,!0,h.toString(t))}gt(e,t){return this.setLimit("min",e,!1,h.toString(t))}lte(e,t){return this.setLimit("max",e,!0,h.toString(t))}lt(e,t){return this.setLimit("max",e,!1,h.toString(t))}setLimit(e,t,r,a){return new e1({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:h.toString(a)}]})}_addCheck(e){return new e1({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:h.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:h.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:h.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:h.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:h.toString(t)})}get minValue(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}e1.create=e=>new e1({checks:[],typeName:f.ZodBigInt,coerce:e?.coerce??!1,...eP(e)});class e9 extends eC{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==ec.boolean){let t=this._getOrReturnCtx(e);return ek(t,{code:em.invalid_type,expected:ec.boolean,received:t.parsedType}),eT}return eZ(e.data)}}e9.create=e=>new e9({typeName:f.ZodBoolean,coerce:e?.coerce||!1,...eP(e)});class e4 extends eC{_parse(e){let t;if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==ec.date){let t=this._getOrReturnCtx(e);return ek(t,{code:em.invalid_type,expected:ec.date,received:t.parsedType}),eT}if(Number.isNaN(e.data.getTime()))return ek(this._getOrReturnCtx(e),{code:em.invalid_date}),eT;let r=new ew;for(let a of this._def.checks)"min"===a.kind?e.data.getTime()<a.value&&(ek(t=this._getOrReturnCtx(e,t),{code:em.too_small,message:a.message,inclusive:!0,exact:!1,minimum:a.value,type:"date"}),r.dirty()):"max"===a.kind?e.data.getTime()>a.value&&(ek(t=this._getOrReturnCtx(e,t),{code:em.too_big,message:a.message,inclusive:!0,exact:!1,maximum:a.value,type:"date"}),r.dirty()):p.assertNever(a);return{status:r.value,value:new Date(e.data.getTime())}}_addCheck(e){return new e4({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:h.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:h.toString(t)})}get minDate(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return null!=e?new Date(e):null}get maxDate(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return null!=e?new Date(e):null}}e4.create=e=>new e4({checks:[],coerce:e?.coerce||!1,typeName:f.ZodDate,...eP(e)});class e2 extends eC{_parse(e){if(this._getType(e)!==ec.symbol){let t=this._getOrReturnCtx(e);return ek(t,{code:em.invalid_type,expected:ec.symbol,received:t.parsedType}),eT}return eZ(e.data)}}e2.create=e=>new e2({typeName:f.ZodSymbol,...eP(e)});class e3 extends eC{_parse(e){if(this._getType(e)!==ec.undefined){let t=this._getOrReturnCtx(e);return ek(t,{code:em.invalid_type,expected:ec.undefined,received:t.parsedType}),eT}return eZ(e.data)}}e3.create=e=>new e3({typeName:f.ZodUndefined,...eP(e)});class e6 extends eC{_parse(e){if(this._getType(e)!==ec.null){let t=this._getOrReturnCtx(e);return ek(t,{code:em.invalid_type,expected:ec.null,received:t.parsedType}),eT}return eZ(e.data)}}e6.create=e=>new e6({typeName:f.ZodNull,...eP(e)});class e5 extends eC{constructor(){super(...arguments),this._any=!0}_parse(e){return eZ(e.data)}}e5.create=e=>new e5({typeName:f.ZodAny,...eP(e)});class e7 extends eC{constructor(){super(...arguments),this._unknown=!0}_parse(e){return eZ(e.data)}}e7.create=e=>new e7({typeName:f.ZodUnknown,...eP(e)});class e8 extends eC{_parse(e){let t=this._getOrReturnCtx(e);return ek(t,{code:em.invalid_type,expected:ec.never,received:t.parsedType}),eT}}e8.create=e=>new e8({typeName:f.ZodNever,...eP(e)});class te extends eC{_parse(e){if(this._getType(e)!==ec.undefined){let t=this._getOrReturnCtx(e);return ek(t,{code:em.invalid_type,expected:ec.void,received:t.parsedType}),eT}return eZ(e.data)}}te.create=e=>new te({typeName:f.ZodVoid,...eP(e)});class tt extends eC{_parse(e){let{ctx:t,status:r}=this._processInputParams(e),a=this._def;if(t.parsedType!==ec.array)return ek(t,{code:em.invalid_type,expected:ec.array,received:t.parsedType}),eT;if(null!==a.exactLength){let e=t.data.length>a.exactLength.value,n=t.data.length<a.exactLength.value;(e||n)&&(ek(t,{code:e?em.too_big:em.too_small,minimum:n?a.exactLength.value:void 0,maximum:e?a.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:a.exactLength.message}),r.dirty())}if(null!==a.minLength&&t.data.length<a.minLength.value&&(ek(t,{code:em.too_small,minimum:a.minLength.value,type:"array",inclusive:!0,exact:!1,message:a.minLength.message}),r.dirty()),null!==a.maxLength&&t.data.length>a.maxLength.value&&(ek(t,{code:em.too_big,maximum:a.maxLength.value,type:"array",inclusive:!0,exact:!1,message:a.maxLength.message}),r.dirty()),t.common.async)return Promise.all([...t.data].map((e,r)=>a.type._parseAsync(new eO(t,e,t.path,r)))).then(e=>ew.mergeArray(r,e));let n=[...t.data].map((e,r)=>a.type._parseSync(new eO(t,e,t.path,r)));return ew.mergeArray(r,n)}get element(){return this._def.type}min(e,t){return new tt({...this._def,minLength:{value:e,message:h.toString(t)}})}max(e,t){return new tt({...this._def,maxLength:{value:e,message:h.toString(t)}})}length(e,t){return new tt({...this._def,exactLength:{value:e,message:h.toString(t)}})}nonempty(e){return this.min(1,e)}}tt.create=(e,t)=>new tt({type:e,minLength:null,maxLength:null,exactLength:null,typeName:f.ZodArray,...eP(t)});class tr extends eC{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(null!==this._cached)return this._cached;let e=this._def.shape(),t=p.objectKeys(e);return this._cached={shape:e,keys:t},this._cached}_parse(e){if(this._getType(e)!==ec.object){let t=this._getOrReturnCtx(e);return ek(t,{code:em.invalid_type,expected:ec.object,received:t.parsedType}),eT}let{status:t,ctx:r}=this._processInputParams(e),{shape:a,keys:n}=this._getCached(),s=[];if(!(this._def.catchall instanceof e8&&"strip"===this._def.unknownKeys))for(let e in r.data)n.includes(e)||s.push(e);let i=[];for(let e of n){let t=a[e],n=r.data[e];i.push({key:{status:"valid",value:e},value:t._parse(new eO(r,n,r.path,e)),alwaysSet:e in r.data})}if(this._def.catchall instanceof e8){let e=this._def.unknownKeys;if("passthrough"===e)for(let e of s)i.push({key:{status:"valid",value:e},value:{status:"valid",value:r.data[e]}});else if("strict"===e)s.length>0&&(ek(r,{code:em.unrecognized_keys,keys:s}),t.dirty());else if("strip"===e);else throw Error("Internal ZodObject error: invalid unknownKeys value.")}else{let e=this._def.catchall;for(let t of s){let a=r.data[t];i.push({key:{status:"valid",value:t},value:e._parse(new eO(r,a,r.path,t)),alwaysSet:t in r.data})}}return r.common.async?Promise.resolve().then(async()=>{let e=[];for(let t of i){let r=await t.key,a=await t.value;e.push({key:r,value:a,alwaysSet:t.alwaysSet})}return e}).then(e=>ew.mergeObjectSync(t,e)):ew.mergeObjectSync(t,i)}get shape(){return this._def.shape()}strict(e){return h.errToObj,new tr({...this._def,unknownKeys:"strict",...void 0!==e?{errorMap:(t,r)=>{let a=this._def.errorMap?.(t,r).message??r.defaultError;return"unrecognized_keys"===t.code?{message:h.errToObj(e).message??a}:{message:a}}}:{}})}strip(){return new tr({...this._def,unknownKeys:"strip"})}passthrough(){return new tr({...this._def,unknownKeys:"passthrough"})}extend(e){return new tr({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new tr({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:f.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new tr({...this._def,catchall:e})}pick(e){let t={};for(let r of p.objectKeys(e))e[r]&&this.shape[r]&&(t[r]=this.shape[r]);return new tr({...this._def,shape:()=>t})}omit(e){let t={};for(let r of p.objectKeys(this.shape))e[r]||(t[r]=this.shape[r]);return new tr({...this._def,shape:()=>t})}deepPartial(){return function e(t){if(t instanceof tr){let r={};for(let a in t.shape){let n=t.shape[a];r[a]=t_.create(e(n))}return new tr({...t._def,shape:()=>r})}if(t instanceof tt)return new tt({...t._def,type:e(t.element)});if(t instanceof t_)return t_.create(e(t.unwrap()));if(t instanceof tb)return tb.create(e(t.unwrap()));if(t instanceof to)return to.create(t.items.map(t=>e(t)));else return t}(this)}partial(e){let t={};for(let r of p.objectKeys(this.shape)){let a=this.shape[r];e&&!e[r]?t[r]=a:t[r]=a.optional()}return new tr({...this._def,shape:()=>t})}required(e){let t={};for(let r of p.objectKeys(this.shape))if(e&&!e[r])t[r]=this.shape[r];else{let e=this.shape[r];for(;e instanceof t_;)e=e._def.innerType;t[r]=e}return new tr({...this._def,shape:()=>t})}keyof(){return th(p.objectKeys(this.shape))}}tr.create=(e,t)=>new tr({shape:()=>e,unknownKeys:"strip",catchall:e8.create(),typeName:f.ZodObject,...eP(t)}),tr.strictCreate=(e,t)=>new tr({shape:()=>e,unknownKeys:"strict",catchall:e8.create(),typeName:f.ZodObject,...eP(t)}),tr.lazycreate=(e,t)=>new tr({shape:e,unknownKeys:"strip",catchall:e8.create(),typeName:f.ZodObject,...eP(t)});class ta extends eC{_parse(e){let{ctx:t}=this._processInputParams(e),r=this._def.options;if(t.common.async)return Promise.all(r.map(async e=>{let r={...t,common:{...t.common,issues:[]},parent:null};return{result:await e._parseAsync({data:t.data,path:t.path,parent:r}),ctx:r}})).then(function(e){for(let t of e)if("valid"===t.result.status)return t.result;for(let r of e)if("dirty"===r.result.status)return t.common.issues.push(...r.ctx.common.issues),r.result;let r=e.map(e=>new ef(e.ctx.common.issues));return ek(t,{code:em.invalid_union,unionErrors:r}),eT});{let e,a=[];for(let n of r){let r={...t,common:{...t.common,issues:[]},parent:null},s=n._parseSync({data:t.data,path:t.path,parent:r});if("valid"===s.status)return s;"dirty"!==s.status||e||(e={result:s,ctx:r}),r.common.issues.length&&a.push(r.common.issues)}if(e)return t.common.issues.push(...e.ctx.common.issues),e.result;let n=a.map(e=>new ef(e));return ek(t,{code:em.invalid_union,unionErrors:n}),eT}}get options(){return this._def.options}}ta.create=(e,t)=>new ta({options:e,typeName:f.ZodUnion,...eP(t)});let tn=e=>{if(e instanceof tp)return tn(e.schema);if(e instanceof tv)return tn(e.innerType());if(e instanceof tm)return[e.value];if(e instanceof tf)return e.options;if(e instanceof ty)return p.objectValues(e.enum);else if(e instanceof tx)return tn(e._def.innerType);else if(e instanceof e3)return[void 0];else if(e instanceof e6)return[null];else if(e instanceof t_)return[void 0,...tn(e.unwrap())];else if(e instanceof tb)return[null,...tn(e.unwrap())];else if(e instanceof tS)return tn(e.unwrap());else if(e instanceof tA)return tn(e.unwrap());else if(e instanceof tk)return tn(e._def.innerType);else return[]};class ts extends eC{_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==ec.object)return ek(t,{code:em.invalid_type,expected:ec.object,received:t.parsedType}),eT;let r=this.discriminator,a=t.data[r],n=this.optionsMap.get(a);return n?t.common.async?n._parseAsync({data:t.data,path:t.path,parent:t}):n._parseSync({data:t.data,path:t.path,parent:t}):(ek(t,{code:em.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),eT)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,r){let a=new Map;for(let r of t){let t=tn(r.shape[e]);if(!t.length)throw Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(let n of t){if(a.has(n))throw Error(`Discriminator property ${String(e)} has duplicate value ${String(n)}`);a.set(n,r)}}return new ts({typeName:f.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:a,...eP(r)})}}class ti extends eC{_parse(e){let{status:t,ctx:r}=this._processInputParams(e),a=(e,a)=>{if(eA(e)||eA(a))return eT;let n=function e(t,r){let a=ep(t),n=ep(r);if(t===r)return{valid:!0,data:t};if(a===ec.object&&n===ec.object){let a=p.objectKeys(r),n=p.objectKeys(t).filter(e=>-1!==a.indexOf(e)),s={...t,...r};for(let a of n){let n=e(t[a],r[a]);if(!n.valid)return{valid:!1};s[a]=n.data}return{valid:!0,data:s}}if(a===ec.array&&n===ec.array){if(t.length!==r.length)return{valid:!1};let a=[];for(let n=0;n<t.length;n++){let s=e(t[n],r[n]);if(!s.valid)return{valid:!1};a.push(s.data)}return{valid:!0,data:a}}if(a===ec.date&&n===ec.date&&+t==+r)return{valid:!0,data:t};return{valid:!1}}(e.value,a.value);return n.valid?((eI(e)||eI(a))&&t.dirty(),{status:t.value,value:n.data}):(ek(r,{code:em.invalid_intersection_types}),eT)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([e,t])=>a(e,t)):a(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}ti.create=(e,t,r)=>new ti({left:e,right:t,typeName:f.ZodIntersection,...eP(r)});class to extends eC{_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==ec.array)return ek(r,{code:em.invalid_type,expected:ec.array,received:r.parsedType}),eT;if(r.data.length<this._def.items.length)return ek(r,{code:em.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),eT;!this._def.rest&&r.data.length>this._def.items.length&&(ek(r,{code:em.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());let a=[...r.data].map((e,t)=>{let a=this._def.items[t]||this._def.rest;return a?a._parse(new eO(r,e,r.path,t)):null}).filter(e=>!!e);return r.common.async?Promise.all(a).then(e=>ew.mergeArray(t,e)):ew.mergeArray(t,a)}get items(){return this._def.items}rest(e){return new to({...this._def,rest:e})}}to.create=(e,t)=>{if(!Array.isArray(e))throw Error("You must pass an array of schemas to z.tuple([ ... ])");return new to({items:e,typeName:f.ZodTuple,rest:null,...eP(t)})};class tl extends eC{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==ec.object)return ek(r,{code:em.invalid_type,expected:ec.object,received:r.parsedType}),eT;let a=[],n=this._def.keyType,s=this._def.valueType;for(let e in r.data)a.push({key:n._parse(new eO(r,e,r.path,e)),value:s._parse(new eO(r,r.data[e],r.path,e)),alwaysSet:e in r.data});return r.common.async?ew.mergeObjectAsync(t,a):ew.mergeObjectSync(t,a)}get element(){return this._def.valueType}static create(e,t,r){return new tl(t instanceof eC?{keyType:e,valueType:t,typeName:f.ZodRecord,...eP(r)}:{keyType:eQ.create(),valueType:e,typeName:f.ZodRecord,...eP(t)})}}class tu extends eC{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==ec.map)return ek(r,{code:em.invalid_type,expected:ec.map,received:r.parsedType}),eT;let a=this._def.keyType,n=this._def.valueType,s=[...r.data.entries()].map(([e,t],s)=>({key:a._parse(new eO(r,e,r.path,[s,"key"])),value:n._parse(new eO(r,t,r.path,[s,"value"]))}));if(r.common.async){let e=new Map;return Promise.resolve().then(async()=>{for(let r of s){let a=await r.key,n=await r.value;if("aborted"===a.status||"aborted"===n.status)return eT;("dirty"===a.status||"dirty"===n.status)&&t.dirty(),e.set(a.value,n.value)}return{status:t.value,value:e}})}{let e=new Map;for(let r of s){let a=r.key,n=r.value;if("aborted"===a.status||"aborted"===n.status)return eT;("dirty"===a.status||"dirty"===n.status)&&t.dirty(),e.set(a.value,n.value)}return{status:t.value,value:e}}}}tu.create=(e,t,r)=>new tu({valueType:t,keyType:e,typeName:f.ZodMap,...eP(r)});class td extends eC{_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==ec.set)return ek(r,{code:em.invalid_type,expected:ec.set,received:r.parsedType}),eT;let a=this._def;null!==a.minSize&&r.data.size<a.minSize.value&&(ek(r,{code:em.too_small,minimum:a.minSize.value,type:"set",inclusive:!0,exact:!1,message:a.minSize.message}),t.dirty()),null!==a.maxSize&&r.data.size>a.maxSize.value&&(ek(r,{code:em.too_big,maximum:a.maxSize.value,type:"set",inclusive:!0,exact:!1,message:a.maxSize.message}),t.dirty());let n=this._def.valueType;function s(e){let r=new Set;for(let a of e){if("aborted"===a.status)return eT;"dirty"===a.status&&t.dirty(),r.add(a.value)}return{status:t.value,value:r}}let i=[...r.data.values()].map((e,t)=>n._parse(new eO(r,e,r.path,t)));return r.common.async?Promise.all(i).then(e=>s(e)):s(i)}min(e,t){return new td({...this._def,minSize:{value:e,message:h.toString(t)}})}max(e,t){return new td({...this._def,maxSize:{value:e,message:h.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}td.create=(e,t)=>new td({valueType:e,minSize:null,maxSize:null,typeName:f.ZodSet,...eP(t)});class tc extends eC{constructor(){super(...arguments),this.validate=this.implement}_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==ec.function)return ek(t,{code:em.invalid_type,expected:ec.function,received:t.parsedType}),eT;function r(e,r){return eb({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,eg,ey].filter(e=>!!e),issueData:{code:em.invalid_arguments,argumentsError:r}})}function a(e,r){return eb({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,eg,ey].filter(e=>!!e),issueData:{code:em.invalid_return_type,returnTypeError:r}})}let n={errorMap:t.common.contextualErrorMap},s=t.data;if(this._def.returns instanceof tg){let e=this;return eZ(async function(...t){let i=new ef([]),o=await e._def.args.parseAsync(t,n).catch(e=>{throw i.addIssue(r(t,e)),i}),l=await Reflect.apply(s,this,o);return await e._def.returns._def.type.parseAsync(l,n).catch(e=>{throw i.addIssue(a(l,e)),i})})}{let e=this;return eZ(function(...t){let i=e._def.args.safeParse(t,n);if(!i.success)throw new ef([r(t,i.error)]);let o=Reflect.apply(s,this,i.data),l=e._def.returns.safeParse(o,n);if(!l.success)throw new ef([a(o,l.error)]);return l.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new tc({...this._def,args:to.create(e).rest(e7.create())})}returns(e){return new tc({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,r){return new tc({args:e||to.create([]).rest(e7.create()),returns:t||e7.create(),typeName:f.ZodFunction,...eP(r)})}}class tp extends eC{get schema(){return this._def.getter()}_parse(e){let{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}tp.create=(e,t)=>new tp({getter:e,typeName:f.ZodLazy,...eP(t)});class tm extends eC{_parse(e){if(e.data!==this._def.value){let t=this._getOrReturnCtx(e);return ek(t,{received:t.data,code:em.invalid_literal,expected:this._def.value}),eT}return{status:"valid",value:e.data}}get value(){return this._def.value}}function th(e,t){return new tf({values:e,typeName:f.ZodEnum,...eP(t)})}tm.create=(e,t)=>new tm({value:e,typeName:f.ZodLiteral,...eP(t)});class tf extends eC{_parse(e){if("string"!=typeof e.data){let t=this._getOrReturnCtx(e),r=this._def.values;return ek(t,{expected:p.joinValues(r),received:t.parsedType,code:em.invalid_type}),eT}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){let t=this._getOrReturnCtx(e),r=this._def.values;return ek(t,{received:t.data,code:em.invalid_enum_value,options:r}),eT}return eZ(e.data)}get options(){return this._def.values}get enum(){let e={};for(let t of this._def.values)e[t]=t;return e}get Values(){let e={};for(let t of this._def.values)e[t]=t;return e}get Enum(){let e={};for(let t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return tf.create(e,{...this._def,...t})}exclude(e,t=this._def){return tf.create(this.options.filter(t=>!e.includes(t)),{...this._def,...t})}}tf.create=th;class ty extends eC{_parse(e){let t=p.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==ec.string&&r.parsedType!==ec.number){let e=p.objectValues(t);return ek(r,{expected:p.joinValues(e),received:r.parsedType,code:em.invalid_type}),eT}if(this._cache||(this._cache=new Set(p.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){let e=p.objectValues(t);return ek(r,{received:r.data,code:em.invalid_enum_value,options:e}),eT}return eZ(e.data)}get enum(){return this._def.values}}ty.create=(e,t)=>new ty({values:e,typeName:f.ZodNativeEnum,...eP(t)});class tg extends eC{unwrap(){return this._def.type}_parse(e){let{ctx:t}=this._processInputParams(e);return t.parsedType!==ec.promise&&!1===t.common.async?(ek(t,{code:em.invalid_type,expected:ec.promise,received:t.parsedType}),eT):eZ((t.parsedType===ec.promise?t.data:Promise.resolve(t.data)).then(e=>this._def.type.parseAsync(e,{path:t.path,errorMap:t.common.contextualErrorMap})))}}tg.create=(e,t)=>new tg({type:e,typeName:f.ZodPromise,...eP(t)});class tv extends eC{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===f.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){let{status:t,ctx:r}=this._processInputParams(e),a=this._def.effect||null,n={addIssue:e=>{ek(r,e),e.fatal?t.abort():t.dirty()},get path(){return r.path}};if(n.addIssue=n.addIssue.bind(n),"preprocess"===a.type){let e=a.transform(r.data,n);if(r.common.async)return Promise.resolve(e).then(async e=>{if("aborted"===t.value)return eT;let a=await this._def.schema._parseAsync({data:e,path:r.path,parent:r});return"aborted"===a.status?eT:"dirty"===a.status||"dirty"===t.value?eS(a.value):a});{if("aborted"===t.value)return eT;let a=this._def.schema._parseSync({data:e,path:r.path,parent:r});return"aborted"===a.status?eT:"dirty"===a.status||"dirty"===t.value?eS(a.value):a}}if("refinement"===a.type){let e=e=>{let t=a.refinement(e,n);if(r.common.async)return Promise.resolve(t);if(t instanceof Promise)throw Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return e};if(!1!==r.common.async)return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(r=>"aborted"===r.status?eT:("dirty"===r.status&&t.dirty(),e(r.value).then(()=>({status:t.value,value:r.value}))));{let a=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return"aborted"===a.status?eT:("dirty"===a.status&&t.dirty(),e(a.value),{status:t.value,value:a.value})}}if("transform"===a.type)if(!1!==r.common.async)return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(e=>eN(e)?Promise.resolve(a.transform(e.value,n)).then(e=>({status:t.value,value:e})):eT);else{let e=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!eN(e))return eT;let s=a.transform(e.value,n);if(s instanceof Promise)throw Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:s}}p.assertNever(a)}}tv.create=(e,t,r)=>new tv({schema:e,typeName:f.ZodEffects,effect:t,...eP(r)}),tv.createWithPreprocess=(e,t,r)=>new tv({schema:t,effect:{type:"preprocess",transform:e},typeName:f.ZodEffects,...eP(r)});class t_ extends eC{_parse(e){return this._getType(e)===ec.undefined?eZ(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}t_.create=(e,t)=>new t_({innerType:e,typeName:f.ZodOptional,...eP(t)});class tb extends eC{_parse(e){return this._getType(e)===ec.null?eZ(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}tb.create=(e,t)=>new tb({innerType:e,typeName:f.ZodNullable,...eP(t)});class tx extends eC{_parse(e){let{ctx:t}=this._processInputParams(e),r=t.data;return t.parsedType===ec.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}tx.create=(e,t)=>new tx({innerType:e,typeName:f.ZodDefault,defaultValue:"function"==typeof t.default?t.default:()=>t.default,...eP(t)});class tk extends eC{_parse(e){let{ctx:t}=this._processInputParams(e),r={...t,common:{...t.common,issues:[]}},a=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return ej(a)?a.then(e=>({status:"valid",value:"valid"===e.status?e.value:this._def.catchValue({get error(){return new ef(r.common.issues)},input:r.data})})):{status:"valid",value:"valid"===a.status?a.value:this._def.catchValue({get error(){return new ef(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}tk.create=(e,t)=>new tk({innerType:e,typeName:f.ZodCatch,catchValue:"function"==typeof t.catch?t.catch:()=>t.catch,...eP(t)});class tw extends eC{_parse(e){if(this._getType(e)!==ec.nan){let t=this._getOrReturnCtx(e);return ek(t,{code:em.invalid_type,expected:ec.nan,received:t.parsedType}),eT}return{status:"valid",value:e.data}}}tw.create=e=>new tw({typeName:f.ZodNaN,...eP(e)});let tT=Symbol("zod_brand");class tS extends eC{_parse(e){let{ctx:t}=this._processInputParams(e),r=t.data;return this._def.type._parse({data:r,path:t.path,parent:t})}unwrap(){return this._def.type}}class tZ extends eC{_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.common.async)return(async()=>{let e=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return"aborted"===e.status?eT:"dirty"===e.status?(t.dirty(),eS(e.value)):this._def.out._parseAsync({data:e.value,path:r.path,parent:r})})();{let e=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return"aborted"===e.status?eT:"dirty"===e.status?(t.dirty(),{status:"dirty",value:e.value}):this._def.out._parseSync({data:e.value,path:r.path,parent:r})}}static create(e,t){return new tZ({in:e,out:t,typeName:f.ZodPipeline})}}class tA extends eC{_parse(e){let t=this._def.innerType._parse(e),r=e=>(eN(e)&&(e.value=Object.freeze(e.value)),e);return ej(t)?t.then(e=>r(e)):r(t)}unwrap(){return this._def.innerType}}function tI(e,t){let r="function"==typeof e?e(t):"string"==typeof e?{message:e}:e;return"string"==typeof r?{message:r}:r}function tN(e,t={},r){return e?e5.create().superRefine((a,n)=>{let s=e(a);if(s instanceof Promise)return s.then(e=>{if(!e){let e=tI(t,a),s=e.fatal??r??!0;n.addIssue({code:"custom",...e,fatal:s})}});if(!s){let e=tI(t,a),s=e.fatal??r??!0;n.addIssue({code:"custom",...e,fatal:s})}}):e5.create()}tA.create=(e,t)=>new tA({innerType:e,typeName:f.ZodReadonly,...eP(t)});let tj={object:tr.lazycreate};(s=f||(f={})).ZodString="ZodString",s.ZodNumber="ZodNumber",s.ZodNaN="ZodNaN",s.ZodBigInt="ZodBigInt",s.ZodBoolean="ZodBoolean",s.ZodDate="ZodDate",s.ZodSymbol="ZodSymbol",s.ZodUndefined="ZodUndefined",s.ZodNull="ZodNull",s.ZodAny="ZodAny",s.ZodUnknown="ZodUnknown",s.ZodNever="ZodNever",s.ZodVoid="ZodVoid",s.ZodArray="ZodArray",s.ZodObject="ZodObject",s.ZodUnion="ZodUnion",s.ZodDiscriminatedUnion="ZodDiscriminatedUnion",s.ZodIntersection="ZodIntersection",s.ZodTuple="ZodTuple",s.ZodRecord="ZodRecord",s.ZodMap="ZodMap",s.ZodSet="ZodSet",s.ZodFunction="ZodFunction",s.ZodLazy="ZodLazy",s.ZodLiteral="ZodLiteral",s.ZodEnum="ZodEnum",s.ZodEffects="ZodEffects",s.ZodNativeEnum="ZodNativeEnum",s.ZodOptional="ZodOptional",s.ZodNullable="ZodNullable",s.ZodDefault="ZodDefault",s.ZodCatch="ZodCatch",s.ZodPromise="ZodPromise",s.ZodBranded="ZodBranded",s.ZodPipeline="ZodPipeline",s.ZodReadonly="ZodReadonly";let tO=(e,t={message:`Input not instance of ${e.name}`})=>tN(t=>t instanceof e,t),tE=eQ.create,tP=e0.create,tC=tw.create,tR=e1.create,t$=e9.create,tM=e4.create,tL=e2.create,tF=e3.create,tz=e6.create,tU=e5.create,tD=e7.create,tV=e8.create,tq=te.create,tB=tt.create,tK=tr.create,tJ=tr.strictCreate,tW=ta.create,tY=ts.create,tH=ti.create,tG=to.create,tX=tl.create,tQ=tu.create,t0=td.create,t1=tc.create,t9=tp.create,t4=tm.create,t2=tf.create,t3=ty.create,t6=tg.create,t5=tv.create,t7=t_.create,t8=tb.create,re=tv.createWithPreprocess,rt=tZ.create,rr=()=>tE().optional(),ra=()=>tP().optional(),rn=()=>t$().optional(),rs={string:e=>eQ.create({...e,coerce:!0}),number:e=>e0.create({...e,coerce:!0}),boolean:e=>e9.create({...e,coerce:!0}),bigint:e=>e1.create({...e,coerce:!0}),date:e=>e4.create({...e,coerce:!0})};function ri(e){if("openAi"!==e.target)return{};let t=[...e.basePath,e.definitionPath,e.openAiAnyTypeName];return e.flags.hasReferencedOpenAiAnyType=!0,{$ref:"relative"===e.$refStrategy?ed(t,e.currentPath):t.join("/")}}function ro(e,t){return rI(e.type._def,t)}e.s(["BRAND",0,tT,"NEVER",0,eT,"Schema",()=>eC,"ZodAny",()=>e5,"ZodArray",()=>tt,"ZodBigInt",()=>e1,"ZodBoolean",()=>e9,"ZodBranded",()=>tS,"ZodCatch",()=>tk,"ZodDate",()=>e4,"ZodDefault",()=>tx,"ZodDiscriminatedUnion",()=>ts,"ZodEffects",()=>tv,"ZodEnum",()=>tf,"ZodFirstPartyTypeKind",()=>f,"ZodFunction",()=>tc,"ZodIntersection",()=>ti,"ZodLazy",()=>tp,"ZodLiteral",()=>tm,"ZodMap",()=>tu,"ZodNaN",()=>tw,"ZodNativeEnum",()=>ty,"ZodNever",()=>e8,"ZodNull",()=>e6,"ZodNullable",()=>tb,"ZodNumber",()=>e0,"ZodObject",()=>tr,"ZodOptional",()=>t_,"ZodPipeline",()=>tZ,"ZodPromise",()=>tg,"ZodReadonly",()=>tA,"ZodRecord",()=>tl,"ZodSchema",()=>eC,"ZodSet",()=>td,"ZodString",()=>eQ,"ZodSymbol",()=>e2,"ZodTransformer",()=>tv,"ZodTuple",()=>to,"ZodType",()=>eC,"ZodUndefined",()=>e3,"ZodUnion",()=>ta,"ZodUnknown",()=>e7,"ZodVoid",()=>te,"any",()=>tU,"array",()=>tB,"bigint",()=>tR,"boolean",()=>t$,"coerce",0,rs,"custom",()=>tN,"date",()=>tM,"datetimeRegex",()=>eX,"discriminatedUnion",()=>tY,"effect",()=>t5,"enum",()=>t2,"function",()=>t1,"instanceof",()=>tO,"intersection",()=>tH,"late",0,tj,"lazy",()=>t9,"literal",()=>t4,"map",()=>tQ,"nan",()=>tC,"nativeEnum",()=>t3,"never",()=>tV,"null",()=>tz,"nullable",()=>t8,"number",()=>tP,"object",()=>tK,"oboolean",()=>rn,"onumber",()=>ra,"optional",()=>t7,"ostring",()=>rr,"pipeline",()=>rt,"preprocess",()=>re,"promise",()=>t6,"record",()=>tX,"set",()=>t0,"strictObject",()=>tJ,"string",()=>tE,"symbol",()=>tL,"transformer",()=>t5,"tuple",()=>tG,"undefined",()=>tF,"union",()=>tW,"unknown",()=>tD,"void",()=>tq],91478);let rl=/^[cC][^\s-]{8,}$/,ru=/^[0-9a-z]+$/,rd=/^[0-9A-HJKMNP-TV-Z]{26}$/,rc=/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,rp=()=>(void 0===r&&(r=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),r),rm=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,rh=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,rf=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,ry=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,rg=/^[a-zA-Z0-9_-]{21}$/,rv=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/;function r_(e,t){let r={type:"string"};if(e.checks)for(let a of e.checks)switch(a.kind){case"min":eu(r,"minLength","number"==typeof r.minLength?Math.max(r.minLength,a.value):a.value,a.message,t);break;case"max":eu(r,"maxLength","number"==typeof r.maxLength?Math.min(r.maxLength,a.value):a.value,a.message,t);break;case"email":switch(t.emailStrategy){case"format:email":rk(r,"email",a.message,t);break;case"format:idn-email":rk(r,"idn-email",a.message,t);break;case"pattern:zod":rw(r,rc,a.message,t)}break;case"url":rk(r,"uri",a.message,t);break;case"uuid":rk(r,"uuid",a.message,t);break;case"regex":rw(r,a.regex,a.message,t);break;case"cuid":rw(r,rl,a.message,t);break;case"cuid2":rw(r,ru,a.message,t);break;case"startsWith":rw(r,RegExp(`^${rb(a.value,t)}`),a.message,t);break;case"endsWith":rw(r,RegExp(`${rb(a.value,t)}$`),a.message,t);break;case"datetime":rk(r,"date-time",a.message,t);break;case"date":rk(r,"date",a.message,t);break;case"time":rk(r,"time",a.message,t);break;case"duration":rk(r,"duration",a.message,t);break;case"length":eu(r,"minLength","number"==typeof r.minLength?Math.max(r.minLength,a.value):a.value,a.message,t),eu(r,"maxLength","number"==typeof r.maxLength?Math.min(r.maxLength,a.value):a.value,a.message,t);break;case"includes":rw(r,RegExp(rb(a.value,t)),a.message,t);break;case"ip":"v6"!==a.version&&rk(r,"ipv4",a.message,t),"v4"!==a.version&&rk(r,"ipv6",a.message,t);break;case"base64url":rw(r,ry,a.message,t);break;case"jwt":rw(r,rv,a.message,t);break;case"cidr":"v6"!==a.version&&rw(r,rm,a.message,t),"v4"!==a.version&&rw(r,rh,a.message,t);break;case"emoji":rw(r,rp(),a.message,t);break;case"ulid":rw(r,rd,a.message,t);break;case"base64":switch(t.base64Strategy){case"format:binary":rk(r,"binary",a.message,t);break;case"contentEncoding:base64":eu(r,"contentEncoding","base64",a.message,t);break;case"pattern:zod":rw(r,rf,a.message,t)}break;case"nanoid":rw(r,rg,a.message,t)}return r}function rb(e,t){return"escape"===t.patternStrategy?function(e){let t="";for(let r=0;r<e.length;r++)rx.has(e[r])||(t+="\\"),t+=e[r];return t}(e):e}let rx=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function rk(e,t,r,a){e.format||e.anyOf?.some(e=>e.format)?(e.anyOf||(e.anyOf=[]),e.format&&(e.anyOf.push({format:e.format,...e.errorMessage&&a.errorMessages&&{errorMessage:{format:e.errorMessage.format}}}),delete e.format,e.errorMessage&&(delete e.errorMessage.format,0===Object.keys(e.errorMessage).length&&delete e.errorMessage)),e.anyOf.push({format:t,...r&&a.errorMessages&&{errorMessage:{format:r}}})):eu(e,"format",t,r,a)}function rw(e,t,r,a){e.pattern||e.allOf?.some(e=>e.pattern)?(e.allOf||(e.allOf=[]),e.pattern&&(e.allOf.push({pattern:e.pattern,...e.errorMessage&&a.errorMessages&&{errorMessage:{pattern:e.errorMessage.pattern}}}),delete e.pattern,e.errorMessage&&(delete e.errorMessage.pattern,0===Object.keys(e.errorMessage).length&&delete e.errorMessage)),e.allOf.push({pattern:rT(t,a),...r&&a.errorMessages&&{errorMessage:{pattern:r}}})):eu(e,"pattern",rT(t,a),r,a)}function rT(e,t){if(!t.applyRegexFlags||!e.flags)return e.source;let r={i:e.flags.includes("i"),m:e.flags.includes("m"),s:e.flags.includes("s")},a=r.i?e.source.toLowerCase():e.source,n="",s=!1,i=!1,o=!1;for(let e=0;e<a.length;e++){if(s){n+=a[e],s=!1;continue}if(r.i){if(i){if(a[e].match(/[a-z]/)){o?(n+=a[e],n+=`${a[e-2]}-${a[e]}`.toUpperCase(),o=!1):"-"===a[e+1]&&a[e+2]?.match(/[a-z]/)?(n+=a[e],o=!0):n+=`${a[e]}${a[e].toUpperCase()}`;continue}}else if(a[e].match(/[a-z]/)){n+=`[${a[e]}${a[e].toUpperCase()}]`;continue}}if(r.m){if("^"===a[e]){n+=`(^|(?<=[\r
]))`;continue}else if("$"===a[e]){n+=`($|(?=[\r
]))`;continue}}if(r.s&&"."===a[e]){n+=i?`${a[e]}\r
`:`[${a[e]}\r
]`;continue}n+=a[e],"\\"===a[e]?s=!0:i&&"]"===a[e]?i=!1:i||"["!==a[e]||(i=!0)}try{new RegExp(n)}catch{return console.warn(`Could not convert regex pattern at ${t.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),e.source}return n}function rS(e,t){if("openAi"===t.target&&console.warn("Warning: OpenAI may not support records in schemas! Try an array of key-value pairs instead."),"openApi3"===t.target&&e.keyType?._def.typeName===f.ZodEnum)return{type:"object",required:e.keyType._def.values,properties:e.keyType._def.values.reduce((r,a)=>({...r,[a]:rI(e.valueType._def,{...t,currentPath:[...t.currentPath,"properties",a]})??ri(t)}),{}),additionalProperties:t.rejectedAdditionalProperties};let r={type:"object",additionalProperties:rI(e.valueType._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??t.allowedAdditionalProperties};if("openApi3"===t.target)return r;if(e.keyType?._def.typeName===f.ZodString&&e.keyType._def.checks?.length){let{type:a,...n}=r_(e.keyType._def,t);return{...r,propertyNames:n}}if(e.keyType?._def.typeName===f.ZodEnum)return{...r,propertyNames:{enum:e.keyType._def.values}};if(e.keyType?._def.typeName===f.ZodBranded&&e.keyType._def.type._def.typeName===f.ZodString&&e.keyType._def.type._def.checks?.length){let{type:a,...n}=ro(e.keyType._def,t);return{...r,propertyNames:n}}return r}let rZ={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"},rA=(e,t)=>{let r=(e.options instanceof Map?Array.from(e.options.values()):e.options).map((e,r)=>rI(e._def,{...t,currentPath:[...t.currentPath,"anyOf",`${r}`]})).filter(e=>!!e&&(!t.strictUnions||"object"==typeof e&&Object.keys(e).length>0));return r.length?{anyOf:r}:void 0};function rI(e,t,r=!1){let a=t.seen.get(e);if(t.override){let n=t.override?.(e,t,a,r);if(n!==ei)return n}if(a&&!r){let e=rN(a,t);if(void 0!==e)return e}let n={def:e,path:t.currentPath,jsonSchema:void 0};t.seen.set(e,n);let s=((e,t,r)=>{switch(t){case f.ZodString:return r_(e,r);case f.ZodNumber:let a={type:"number"};if(!e.checks)return a;for(let t of e.checks)switch(t.kind){case"int":a.type="integer",el(a,"type",t.message,r);break;case"min":"jsonSchema7"===r.target?t.inclusive?eu(a,"minimum",t.value,t.message,r):eu(a,"exclusiveMinimum",t.value,t.message,r):(t.inclusive||(a.exclusiveMinimum=!0),eu(a,"minimum",t.value,t.message,r));break;case"max":"jsonSchema7"===r.target?t.inclusive?eu(a,"maximum",t.value,t.message,r):eu(a,"exclusiveMaximum",t.value,t.message,r):(t.inclusive||(a.exclusiveMaximum=!0),eu(a,"maximum",t.value,t.message,r));break;case"multipleOf":eu(a,"multipleOf",t.value,t.message,r)}return a;case f.ZodObject:return function(e,t){let r="openAi"===t.target,a={type:"object",properties:{}},n=[],s=e.shape();for(let e in s){let i=s[e];if(void 0===i||void 0===i._def)continue;let o=function(e){try{return e.isOptional()}catch{return!0}}(i);o&&r&&("ZodOptional"===i._def.typeName&&(i=i._def.innerType),i.isNullable()||(i=i.nullable()),o=!1);let l=rI(i._def,{...t,currentPath:[...t.currentPath,"properties",e],propertyPath:[...t.currentPath,"properties",e]});void 0!==l&&(a.properties[e]=l,o||n.push(e))}n.length&&(a.required=n);let i=function(e,t){if("ZodNever"!==e.catchall._def.typeName)return rI(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]});switch(e.unknownKeys){case"passthrough":return t.allowedAdditionalProperties;case"strict":return t.rejectedAdditionalProperties;case"strip":return"strict"===t.removeAdditionalStrategy?t.allowedAdditionalProperties:t.rejectedAdditionalProperties}}(e,t);return void 0!==i&&(a.additionalProperties=i),a}(e,r);case f.ZodBigInt:let n={type:"integer",format:"int64"};if(!e.checks)return n;for(let t of e.checks)switch(t.kind){case"min":"jsonSchema7"===r.target?t.inclusive?eu(n,"minimum",t.value,t.message,r):eu(n,"exclusiveMinimum",t.value,t.message,r):(t.inclusive||(n.exclusiveMinimum=!0),eu(n,"minimum",t.value,t.message,r));break;case"max":"jsonSchema7"===r.target?t.inclusive?eu(n,"maximum",t.value,t.message,r):eu(n,"exclusiveMaximum",t.value,t.message,r):(t.inclusive||(n.exclusiveMaximum=!0),eu(n,"maximum",t.value,t.message,r));break;case"multipleOf":eu(n,"multipleOf",t.value,t.message,r)}return n;case f.ZodBoolean:return{type:"boolean"};case f.ZodDate:return function e(t,r,a){let n=a??r.dateStrategy;if(Array.isArray(n))return{anyOf:n.map((a,n)=>e(t,r,a))};switch(n){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":var s=t,i=r;let o={type:"integer",format:"unix-time"};if("openApi3"===i.target)return o;for(let e of s.checks)switch(e.kind){case"min":eu(o,"minimum",e.value,e.message,i);break;case"max":eu(o,"maximum",e.value,e.message,i)}return o}}(e,r);case f.ZodUndefined:return{not:ri(r)};case f.ZodNull:return"openApi3"===r.target?{enum:["null"],nullable:!0}:{type:"null"};case f.ZodArray:let s;return s={type:"array"},e.type?._def&&e.type?._def?.typeName!==f.ZodAny&&(s.items=rI(e.type._def,{...r,currentPath:[...r.currentPath,"items"]})),e.minLength&&eu(s,"minItems",e.minLength.value,e.minLength.message,r),e.maxLength&&eu(s,"maxItems",e.maxLength.value,e.maxLength.message,r),e.exactLength&&(eu(s,"minItems",e.exactLength.value,e.exactLength.message,r),eu(s,"maxItems",e.exactLength.value,e.exactLength.message,r)),s;case f.ZodUnion:case f.ZodDiscriminatedUnion:if("openApi3"===r.target)return rA(e,r);let i=e.options instanceof Map?Array.from(e.options.values()):e.options;if(i.every(e=>e._def.typeName in rZ&&(!e._def.checks||!e._def.checks.length))){let e=i.reduce((e,t)=>{let r=rZ[t._def.typeName];return r&&!e.includes(r)?[...e,r]:e},[]);return{type:e.length>1?e:e[0]}}if(i.every(e=>"ZodLiteral"===e._def.typeName&&!e.description)){let e=i.reduce((e,t)=>{let r=typeof t._def.value;switch(r){case"string":case"number":case"boolean":return[...e,r];case"bigint":return[...e,"integer"];case"object":if(null===t._def.value)return[...e,"null"];default:return e}},[]);if(e.length===i.length){let t=e.filter((e,t,r)=>r.indexOf(e)===t);return{type:t.length>1?t:t[0],enum:i.reduce((e,t)=>e.includes(t._def.value)?e:[...e,t._def.value],[])}}}else if(i.every(e=>"ZodEnum"===e._def.typeName))return{type:"string",enum:i.reduce((e,t)=>[...e,...t._def.values.filter(t=>!e.includes(t))],[])};return rA(e,r);case f.ZodIntersection:let o,l,u;return o=[rI(e.left._def,{...r,currentPath:[...r.currentPath,"allOf","0"]}),rI(e.right._def,{...r,currentPath:[...r.currentPath,"allOf","1"]})].filter(e=>!!e),l="jsonSchema2019-09"===r.target?{unevaluatedProperties:!1}:void 0,u=[],o.forEach(e=>{if((!("type"in e)||"string"!==e.type)&&"allOf"in e)u.push(...e.allOf),void 0===e.unevaluatedProperties&&(l=void 0);else{let t=e;if("additionalProperties"in e&&!1===e.additionalProperties){let{additionalProperties:r,...a}=e;t=a}else l=void 0;u.push(t)}}),u.length?{allOf:u,...l}:void 0;case f.ZodTuple:return e.rest?{type:"array",minItems:e.items.length,items:e.items.map((e,t)=>rI(e._def,{...r,currentPath:[...r.currentPath,"items",`${t}`]})).reduce((e,t)=>void 0===t?e:[...e,t],[]),additionalItems:rI(e.rest._def,{...r,currentPath:[...r.currentPath,"additionalItems"]})}:{type:"array",minItems:e.items.length,maxItems:e.items.length,items:e.items.map((e,t)=>rI(e._def,{...r,currentPath:[...r.currentPath,"items",`${t}`]})).reduce((e,t)=>void 0===t?e:[...e,t],[])};case f.ZodRecord:return rS(e,r);case f.ZodLiteral:let d;return"bigint"!=(d=typeof e.value)&&"number"!==d&&"boolean"!==d&&"string"!==d?{type:Array.isArray(e.value)?"array":"object"}:"openApi3"===r.target?{type:"bigint"===d?"integer":d,enum:[e.value]}:{type:"bigint"===d?"integer":d,const:e.value};case f.ZodEnum:return{type:"string",enum:Array.from(e.values)};case f.ZodNativeEnum:let c,p,m;return c=e.values,{type:1===(m=Array.from(new Set((p=Object.keys(e.values).filter(e=>"number"!=typeof c[c[e]]).map(e=>c[e])).map(e=>typeof e)))).length?"string"===m[0]?"string":"number":["string","number"],enum:p};case f.ZodNullable:if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(e.innerType._def.typeName)&&(!e.innerType._def.checks||!e.innerType._def.checks.length))return"openApi3"===r.target?{type:rZ[e.innerType._def.typeName],nullable:!0}:{type:[rZ[e.innerType._def.typeName],"null"]};if("openApi3"===r.target){let t=rI(e.innerType._def,{...r,currentPath:[...r.currentPath]});return t&&"$ref"in t?{allOf:[t],nullable:!0}:t&&{...t,nullable:!0}}let h=rI(e.innerType._def,{...r,currentPath:[...r.currentPath,"anyOf","0"]});return h&&{anyOf:[h,{type:"null"}]};case f.ZodOptional:if(r.currentPath.toString()===r.propertyPath?.toString())return rI(e.innerType._def,r);let y=rI(e.innerType._def,{...r,currentPath:[...r.currentPath,"anyOf","1"]});return y?{anyOf:[{not:ri(r)},y]}:ri(r);case f.ZodMap:if("record"===r.mapStrategy)return rS(e,r);return{type:"array",maxItems:125,items:{type:"array",items:[rI(e.keyType._def,{...r,currentPath:[...r.currentPath,"items","items","0"]})||ri(r),rI(e.valueType._def,{...r,currentPath:[...r.currentPath,"items","items","1"]})||ri(r)],minItems:2,maxItems:2}};case f.ZodSet:let g;return g={type:"array",uniqueItems:!0,items:rI(e.valueType._def,{...r,currentPath:[...r.currentPath,"items"]})},e.minSize&&eu(g,"minItems",e.minSize.value,e.minSize.message,r),e.maxSize&&eu(g,"maxItems",e.maxSize.value,e.maxSize.message,r),g;case f.ZodLazy:return()=>e.getter()._def;case f.ZodPromise:return rI(e.type._def,r);case f.ZodNaN:case f.ZodNever:return"openAi"===r.target?void 0:{not:ri({...r,currentPath:[...r.currentPath,"not"]})};case f.ZodEffects:return"input"===r.effectStrategy?rI(e.schema._def,r):ri(r);case f.ZodAny:case f.ZodUnknown:return ri(r);case f.ZodDefault:return{...rI(e.innerType._def,r),default:e.defaultValue()};case f.ZodBranded:return ro(e,r);case f.ZodReadonly:case f.ZodCatch:return rI(e.innerType._def,r);case f.ZodPipeline:if("input"===r.pipeStrategy)return rI(e.in._def,r);if("output"===r.pipeStrategy)return rI(e.out._def,r);let v=rI(e.in._def,{...r,currentPath:[...r.currentPath,"allOf","0"]}),_=rI(e.out._def,{...r,currentPath:[...r.currentPath,"allOf",v?"1":"0"]});return{allOf:[v,_].filter(e=>void 0!==e)};case f.ZodFunction:case f.ZodVoid:case f.ZodSymbol:default:return}})(e,e.typeName,t),i="function"==typeof s?rI(s(),t):s;if(i&&rj(e,t,i),t.postProcess){let r=t.postProcess(i,e,t);return n.jsonSchema=i,r}return n.jsonSchema=i,i}let rN=(e,t)=>{switch(t.$refStrategy){case"root":return{$ref:e.path.join("/")};case"relative":return{$ref:ed(t.currentPath,e.path)};case"none":case"seen":if(e.path.length<t.currentPath.length&&e.path.every((e,r)=>t.currentPath[r]===e))return console.warn(`Recursive reference detected at ${t.currentPath.join("/")}! Defaulting to any`),ri(t);return"seen"===t.$refStrategy?ri(t):void 0}},rj=(e,t,r)=>(e.description&&(r.description=e.description,t.markdownDescription&&(r.markdownDescription=e.description)),r);var rO={code:"0",name:"text",parse:e=>{if("string"!=typeof e)throw Error('"text" parts expect a string value.');return{type:"text",value:e}}},rE={code:"3",name:"error",parse:e=>{if("string"!=typeof e)throw Error('"error" parts expect a string value.');return{type:"error",value:e}}},rP={code:"4",name:"assistant_message",parse:e=>{if(null==e||"object"!=typeof e||!("id"in e)||!("role"in e)||!("content"in e)||"string"!=typeof e.id||"string"!=typeof e.role||"assistant"!==e.role||!Array.isArray(e.content)||!e.content.every(e=>null!=e&&"object"==typeof e&&"type"in e&&"text"===e.type&&"text"in e&&null!=e.text&&"object"==typeof e.text&&"value"in e.text&&"string"==typeof e.text.value))throw Error('"assistant_message" parts expect an object with an "id", "role", and "content" property.');return{type:"assistant_message",value:e}}},rC={code:"5",name:"assistant_control_data",parse:e=>{if(null==e||"object"!=typeof e||!("threadId"in e)||!("messageId"in e)||"string"!=typeof e.threadId||"string"!=typeof e.messageId)throw Error('"assistant_control_data" parts expect an object with a "threadId" and "messageId" property.');return{type:"assistant_control_data",value:{threadId:e.threadId,messageId:e.messageId}}}},rR={code:"6",name:"data_message",parse:e=>{if(null==e||"object"!=typeof e||!("role"in e)||!("data"in e)||"string"!=typeof e.role||"data"!==e.role)throw Error('"data_message" parts expect an object with a "role" and "data" property.');return{type:"data_message",value:e}}},r$=[rO,rE,rP,rC,rR];rO.code,rE.code,rP.code,rC.code,rR.code,rO.name,rO.code,rE.name,rE.code,rP.name,rP.code,rC.name,rC.code,rR.name,rR.code,r$.map(e=>e.code);var rM={code:"0",name:"text",parse:e=>{if("string"!=typeof e)throw Error('"text" parts expect a string value.');return{type:"text",value:e}}},rL={code:"2",name:"data",parse:e=>{if(!Array.isArray(e))throw Error('"data" parts expect an array value.');return{type:"data",value:e}}},rF={code:"3",name:"error",parse:e=>{if("string"!=typeof e)throw Error('"error" parts expect a string value.');return{type:"error",value:e}}},rz={code:"8",name:"message_annotations",parse:e=>{if(!Array.isArray(e))throw Error('"message_annotations" parts expect an array value.');return{type:"message_annotations",value:e}}},rU={code:"9",name:"tool_call",parse:e=>{if(null==e||"object"!=typeof e||!("toolCallId"in e)||"string"!=typeof e.toolCallId||!("toolName"in e)||"string"!=typeof e.toolName||!("args"in e)||"object"!=typeof e.args)throw Error('"tool_call" parts expect an object with a "toolCallId", "toolName", and "args" property.');return{type:"tool_call",value:e}}},rD={code:"a",name:"tool_result",parse:e=>{if(null==e||"object"!=typeof e||!("toolCallId"in e)||"string"!=typeof e.toolCallId||!("result"in e))throw Error('"tool_result" parts expect an object with a "toolCallId" and a "result" property.');return{type:"tool_result",value:e}}},rV={code:"b",name:"tool_call_streaming_start",parse:e=>{if(null==e||"object"!=typeof e||!("toolCallId"in e)||"string"!=typeof e.toolCallId||!("toolName"in e)||"string"!=typeof e.toolName)throw Error('"tool_call_streaming_start" parts expect an object with a "toolCallId" and "toolName" property.');return{type:"tool_call_streaming_start",value:e}}},rq={code:"c",name:"tool_call_delta",parse:e=>{if(null==e||"object"!=typeof e||!("toolCallId"in e)||"string"!=typeof e.toolCallId||!("argsTextDelta"in e)||"string"!=typeof e.argsTextDelta)throw Error('"tool_call_delta" parts expect an object with a "toolCallId" and "argsTextDelta" property.');return{type:"tool_call_delta",value:e}}},rB={code:"d",name:"finish_message",parse:e=>{if(null==e||"object"!=typeof e||!("finishReason"in e)||"string"!=typeof e.finishReason)throw Error('"finish_message" parts expect an object with a "finishReason" property.');let t={finishReason:e.finishReason};return"usage"in e&&null!=e.usage&&"object"==typeof e.usage&&"promptTokens"in e.usage&&"completionTokens"in e.usage&&(t.usage={promptTokens:"number"==typeof e.usage.promptTokens?e.usage.promptTokens:NaN,completionTokens:"number"==typeof e.usage.completionTokens?e.usage.completionTokens:NaN}),{type:"finish_message",value:t}}},rK={code:"e",name:"finish_step",parse:e=>{if(null==e||"object"!=typeof e||!("finishReason"in e)||"string"!=typeof e.finishReason)throw Error('"finish_step" parts expect an object with a "finishReason" property.');let t={finishReason:e.finishReason,isContinued:!1};return"usage"in e&&null!=e.usage&&"object"==typeof e.usage&&"promptTokens"in e.usage&&"completionTokens"in e.usage&&(t.usage={promptTokens:"number"==typeof e.usage.promptTokens?e.usage.promptTokens:NaN,completionTokens:"number"==typeof e.usage.completionTokens?e.usage.completionTokens:NaN}),"isContinued"in e&&"boolean"==typeof e.isContinued&&(t.isContinued=e.isContinued),{type:"finish_step",value:t}}},rJ=[rM,rL,rF,rz,rU,rD,rV,rq,rB,rK];function rW(e,t){let r=rJ.find(t=>t.name===e);if(!r)throw Error(`Invalid stream part type: ${e}`);return`${r.code}:${JSON.stringify(t)}
`}rM.code,rL.code,rF.code,rz.code,rU.code,rD.code,rV.code,rq.code,rB.code,rK.code,rM.name,rM.code,rL.name,rL.code,rF.name,rF.code,rz.name,rz.code,rU.name,rU.code,rD.name,rD.code,rV.name,rV.code,rq.name,rq.code,rB.name,rB.code,rK.name,rK.code,rJ.map(e=>e.code);var rY=Symbol.for("vercel.ai.schema");function rH(e){var t;return"object"==typeof e&&null!==e&&rY in e&&!0===e[rY]&&"jsonSchema"in e&&"validate"in e?e:function(e,{validate:t}={}){return{[rY]:!0,_type:void 0,[ee]:!0,jsonSchema:e,validate:t}}(((e,t)=>{let r,a,n=(a=void 0!==(r="string"==typeof t?{...eo,name:t}:{...eo,...t}).name?[...r.basePath,r.definitionPath,r.name]:r.basePath,{...r,flags:{hasReferencedOpenAiAnyType:!1},currentPath:a,propertyPath:void 0,seen:new Map(Object.entries(r.definitions).map(([e,t])=>[t._def,{def:t._def,path:[...r.basePath,r.definitionPath,e],jsonSchema:void 0}]))}),s="object"==typeof t&&t.definitions?Object.entries(t.definitions).reduce((e,[t,r])=>({...e,[t]:rI(r._def,{...n,currentPath:[...n.basePath,n.definitionPath,t]},!0)??ri(n)}),{}):void 0,i="string"==typeof t?t:t?.nameStrategy==="title"?void 0:t?.name,o=rI(e._def,void 0===i?n:{...n,currentPath:[...n.basePath,n.definitionPath,i]},!1)??ri(n),l="object"==typeof t&&void 0!==t.name&&"title"===t.nameStrategy?t.name:void 0;void 0!==l&&(o.title=l),n.flags.hasReferencedOpenAiAnyType&&(s||(s={}),s[n.openAiAnyTypeName]||(s[n.openAiAnyTypeName]={type:["string","number","integer","boolean","array","null"],items:{$ref:"relative"===n.$refStrategy?"1":[...n.basePath,n.definitionPath,n.openAiAnyTypeName].join("/")}}));let u=void 0===i?s?{...o,[n.definitionPath]:s}:o:{$ref:[..."relative"===n.$refStrategy?[]:n.basePath,n.definitionPath,i].join("/"),[n.definitionPath]:{...s,[i]:o}};return"jsonSchema7"===n.target?u.$schema="http://json-schema.org/draft-07/schema#":("jsonSchema2019-09"===n.target||"openAi"===n.target)&&(u.$schema="https://json-schema.org/draft/2019-09/schema#"),"openAi"===n.target&&("anyOf"in u||"oneOf"in u||"allOf"in u||"type"in u&&Array.isArray(u.type))&&console.warn("Warning: OpenAI may not support schemas with unions as roots! Try wrapping it in an object property."),u})(t=e),{validate:e=>{let r=t.safeParse(e);return r.success?{success:!0,value:r.data}:{success:!1,error:r.error}}})}var rG=e.i(74812),rX=e.i(14664);e.s([],72340),e.i(72340),e.i(13297),e.s(["defaultErrorMap",0,ey,"getErrorMap",()=>e_,"setErrorMap",()=>ev],30523),e.i(30523),e.i(6686),e.s([],24389),e.i(24389),e.i(16013),e.i(91478),e.i(32218),e.s(["BRAND",0,tT,"DIRTY",0,eS,"EMPTY_PATH",0,ex,"INVALID",0,eT,"NEVER",0,eT,"OK",0,eZ,"ParseStatus",()=>ew,"Schema",()=>eC,"ZodAny",()=>e5,"ZodArray",()=>tt,"ZodBigInt",()=>e1,"ZodBoolean",()=>e9,"ZodBranded",()=>tS,"ZodCatch",()=>tk,"ZodDate",()=>e4,"ZodDefault",()=>tx,"ZodDiscriminatedUnion",()=>ts,"ZodEffects",()=>tv,"ZodEnum",()=>tf,"ZodError",()=>ef,"ZodFirstPartyTypeKind",()=>f,"ZodFunction",()=>tc,"ZodIntersection",()=>ti,"ZodIssueCode",0,em,"ZodLazy",()=>tp,"ZodLiteral",()=>tm,"ZodMap",()=>tu,"ZodNaN",()=>tw,"ZodNativeEnum",()=>ty,"ZodNever",()=>e8,"ZodNull",()=>e6,"ZodNullable",()=>tb,"ZodNumber",()=>e0,"ZodObject",()=>tr,"ZodOptional",()=>t_,"ZodParsedType",0,ec,"ZodPipeline",()=>tZ,"ZodPromise",()=>tg,"ZodReadonly",()=>tA,"ZodRecord",()=>tl,"ZodSchema",()=>eC,"ZodSet",()=>td,"ZodString",()=>eQ,"ZodSymbol",()=>e2,"ZodTransformer",()=>tv,"ZodTuple",()=>to,"ZodType",()=>eC,"ZodUndefined",()=>e3,"ZodUnion",()=>ta,"ZodUnknown",()=>e7,"ZodVoid",()=>te,"addIssueToContext",()=>ek,"any",()=>tU,"array",()=>tB,"bigint",()=>tR,"boolean",()=>t$,"coerce",0,rs,"custom",()=>tN,"date",()=>tM,"datetimeRegex",()=>eX,"defaultErrorMap",0,ey,"discriminatedUnion",()=>tY,"effect",()=>t5,"enum",()=>t2,"function",()=>t1,"getErrorMap",()=>e_,"getParsedType",0,ep,"instanceof",()=>tO,"intersection",()=>tH,"isAborted",0,eA,"isAsync",0,ej,"isDirty",0,eI,"isValid",0,eN,"late",0,tj,"lazy",()=>t9,"literal",()=>t4,"makeIssue",0,eb,"map",()=>tQ,"nan",()=>tC,"nativeEnum",()=>t3,"never",()=>tV,"null",()=>tz,"nullable",()=>t8,"number",()=>tP,"object",()=>tK,"objectUtil",()=>m,"oboolean",()=>rn,"onumber",()=>ra,"optional",()=>t7,"ostring",()=>rr,"pipeline",()=>rt,"preprocess",()=>re,"promise",()=>t6,"quotelessJson",0,eh,"record",()=>tX,"set",()=>t0,"setErrorMap",()=>ev,"strictObject",()=>tJ,"string",()=>tE,"symbol",()=>tL,"transformer",()=>t5,"tuple",()=>tG,"undefined",()=>tF,"union",()=>tW,"unknown",()=>tD,"util",()=>p,"void",()=>tq],47981);var rQ=e.i(47981),rQ=rQ,r0=Object.defineProperty,r1=(e,t)=>{for(var r in t)r0(e,r,{get:t[r],enumerable:!0})};function r9(e,{contentType:t,dataStreamVersion:r}){let a=new Headers(null!=e?e:{});return a.has("Content-Type")||a.set("Content-Type",t),void 0!==r&&a.set("X-Vercel-AI-Data-Stream",r),a}var r4="AI_InvalidArgumentError",r2=`vercel.ai.error.${r4}`,r3=Symbol.for(r2),r6=class extends j{constructor({parameter:e,value:t,message:r}){super({name:r4,message:`Invalid argument for parameter ${e}: ${r}`}),this[y]=!0,this.parameter=e,this.value=t}static isInstance(e){return j.hasMarker(e,r2)}};async function r5(e){return void 0===e?Promise.resolve():new Promise(t=>setTimeout(t,e))}y=r3;var r7="AI_RetryError",r8=`vercel.ai.error.${r7}`,ae=Symbol.for(r8),at=class extends j{constructor({message:e,reason:t,errors:r}){super({name:r7,message:e}),this[g]=!0,this.reason=t,this.errors=r,this.lastError=r[r.length-1]}static isInstance(e){return j.hasMarker(e,r8)}};async function ar(e,{maxRetries:t,delayInMs:r,backoffFactor:a},n=[]){try{return await e()}catch(l){if(l instanceof Error&&("AbortError"===l.name||"TimeoutError"===l.name)||0===t)throw l;let s=null==l?"unknown error":"string"==typeof l?l:l instanceof Error?l.message:JSON.stringify(l),i=[...n,l],o=i.length;if(o>t)throw new at({message:`Failed after ${o} attempts. Last error: ${s}`,reason:"maxRetriesExceeded",errors:i});if(l instanceof Error&&C.isInstance(l)&&!0===l.isRetryable&&o<=t)return await r5(r),ar(e,{maxRetries:t,delayInMs:a*r,backoffFactor:a},i);if(1===o)throw l;throw new at({message:`Failed after ${o} attempts with non-retryable error: '${s}'`,reason:"errorNotRetryable",errors:i})}}function aa({operationId:e,telemetry:t}){return{"operation.name":`${e}${(null==t?void 0:t.functionId)!=null?` ${t.functionId}`:""}`,"resource.name":null==t?void 0:t.functionId,"ai.operationId":e,"ai.telemetry.functionId":null==t?void 0:t.functionId}}g=ae;var an={startSpan:()=>as,startActiveSpan:(e,t,r,a)=>"function"==typeof t?t(as):"function"==typeof r?r(as):"function"==typeof a?a(as):void 0},as={spanContext:()=>ai,setAttribute(){return this},setAttributes(){return this},addEvent(){return this},addLink(){return this},addLinks(){return this},setStatus(){return this},updateName(){return this},end(){return this},isRecording:()=>!1,recordException(){return this}},ai={traceId:"",spanId:"",traceFlags:0};function ao({name:e,tracer:t,attributes:r,fn:a,endWhenDone:n=!0}){return t.startActiveSpan(e,{attributes:r},async e=>{try{let t=await a(e);return n&&e.end(),t}catch(t){try{t instanceof Error?(e.recordException({name:t.name,message:t.message,stack:t.stack}),e.setStatus({code:rX.SpanStatusCode.ERROR,message:t.message})):e.setStatus({code:rX.SpanStatusCode.ERROR})}finally{e.end()}throw t}})}function al({telemetry:e,attributes:t}){return(null==e?void 0:e.isEnabled)!==!0?{}:Object.entries(t).reduce((t,[r,a])=>{if(void 0===a)return t;if("object"==typeof a&&"input"in a&&"function"==typeof a.input){if((null==e?void 0:e.recordInputs)===!1)return t;let n=a.input();return void 0===n?t:{...t,[r]:n}}if("object"==typeof a&&"output"in a&&"function"==typeof a.output){if((null==e?void 0:e.recordOutputs)===!1)return t;let n=a.output();return void 0===n?t:{...t,[r]:n}}return{...t,[r]:a}},{})}var au="AI_NoObjectGeneratedError",ad=`vercel.ai.error.${au}`,ac=Symbol.for(ad),ap=class extends j{constructor({message:e="No object generated.",cause:t,text:r,response:a,usage:n}){super({name:au,message:e,cause:t}),this[v]=!0,this.text=r,this.response=a,this.usage=n}static isInstance(e){return j.hasMarker(e,ad)}};v=ac;var am="AI_DownloadError",ah=`vercel.ai.error.${am}`,af=Symbol.for(ah),ay=class extends j{constructor({url:e,statusCode:t,statusText:r,cause:a,message:n=null==a?`Failed to download ${e}: ${t} ${r}`:`Failed to download ${e}: ${a}`}){super({name:am,message:n,cause:a}),this[_]=!0,this.url=e,this.statusCode=t,this.statusText=r}static isInstance(e){return j.hasMarker(e,ah)}};async function ag({url:e,fetchImplementation:t=fetch}){var r;let a=e.toString();try{let e=await t(a);if(!e.ok)throw new ay({url:a,statusCode:e.status,statusText:e.statusText});return{data:new Uint8Array(await e.arrayBuffer()),mimeType:null!=(r=e.headers.get("content-type"))?r:void 0}}catch(e){if(ay.isInstance(e))throw e;throw new ay({url:a,cause:e})}}_=af;var av=[{mimeType:"image/gif",bytes:[71,73,70]},{mimeType:"image/png",bytes:[137,80,78,71]},{mimeType:"image/jpeg",bytes:[255,216]},{mimeType:"image/webp",bytes:[82,73,70,70]}],a_="AI_InvalidDataContentError",ab=`vercel.ai.error.${a_}`,ax=Symbol.for(ab),ak=class extends j{constructor({content:e,cause:t,message:r=`Invalid data content. Expected a base64 string, Uint8Array, ArrayBuffer, or Buffer, but got ${typeof e}.`}){super({name:a_,message:r,cause:t}),this[b]=!0,this.content=e}static isInstance(e){return j.hasMarker(e,ab)}};b=ax;var aw=rQ.union([rQ.string(),rQ.instanceof(Uint8Array),rQ.instanceof(ArrayBuffer),rQ.custom(e=>{var t,r;return null!=(r=null==(t=globalThis.Buffer)?void 0:t.isBuffer(e))&&r},{message:"Must be a Buffer"})]);function aT(e){if(e instanceof Uint8Array)return e;if("string"==typeof e)try{let t;return t=en(e.replace(/-/g,"+").replace(/_/g,"/")),Uint8Array.from(t,e=>e.codePointAt(0))}catch(t){throw new ak({message:"Invalid data content. Content string is not a base64-encoded media.",content:e,cause:t})}if(e instanceof ArrayBuffer)return new Uint8Array(e);throw new ak({content:e})}var aS="AI_InvalidMessageRoleError",aZ=`vercel.ai.error.${aS}`,aA=Symbol.for(aZ),aI=class extends j{constructor({role:e,message:t=`Invalid message role: '${e}'. Must be one of: "system", "user", "assistant", "tool".`}){super({name:aS,message:t}),this[x]=!0,this.role=e}static isInstance(e){return j.hasMarker(e,aZ)}};async function aN({prompt:e,modelSupportsImageUrls:t=!0,modelSupportsUrl:r=()=>!1,downloadImplementation:a=ag}){let n=await aj(e.messages,a,t,r);return[...null!=e.system?[{role:"system",content:e.system}]:[],...e.messages.map(e=>(function(e,t){let r=e.role;switch(r){case"system":return{role:"system",content:e.content,providerMetadata:e.experimental_providerMetadata};case"user":if("string"==typeof e.content)return{role:"user",content:[{type:"text",text:e.content}],providerMetadata:e.experimental_providerMetadata};return{role:"user",content:e.content.map(e=>(function(e,t){var r,a;let n,s,i;if("text"===e.type)return{type:"text",text:e.text,providerMetadata:e.experimental_providerMetadata};let o=e.mimeType,l=e.type;switch(l){case"image":n=e.image;break;case"file":n=e.data;break;default:throw Error(`Unsupported part type: ${l}`)}try{s="string"==typeof n?new URL(n):n}catch(e){s=n}if(s instanceof URL)if("data:"===s.protocol){let{mimeType:e,base64Content:t}=function(e){try{let[t,r]=e.split(",");return{mimeType:t.split(";")[0].split(":")[1],base64Content:r}}catch(e){return{mimeType:void 0,base64Content:void 0}}}(s.toString());if(null==e||null==t)throw Error(`Invalid data URL format in part ${l}`);o=e,i=aT(t)}else{let e=t[s.toString()];e?(i=e.data,null!=o||(o=e.mimeType)):i=s}else i=aT(s);switch(l){case"image":return i instanceof Uint8Array&&(o=null!=(r=function(e){for(let{bytes:t,mimeType:r}of av)if(e.length>=t.length&&t.every((t,r)=>e[r]===t))return r}(i))?r:o),{type:"image",image:i,mimeType:o,providerMetadata:e.experimental_providerMetadata};case"file":if(null==o)throw Error("Mime type is missing for file part");return{type:"file",data:i instanceof Uint8Array?"string"==typeof(a=i)?a:a instanceof ArrayBuffer?es(new Uint8Array(a)):es(a):i,mimeType:o,providerMetadata:e.experimental_providerMetadata}}})(e,t)).filter(e=>"text"!==e.type||""!==e.text),providerMetadata:e.experimental_providerMetadata};case"assistant":if("string"==typeof e.content)return{role:"assistant",content:[{type:"text",text:e.content}],providerMetadata:e.experimental_providerMetadata};return{role:"assistant",content:e.content.filter(e=>"text"!==e.type||""!==e.text).map(e=>{let{experimental_providerMetadata:t,...r}=e;return{...r,providerMetadata:t}}),providerMetadata:e.experimental_providerMetadata};case"tool":return{role:"tool",content:e.content.map(e=>({type:"tool-result",toolCallId:e.toolCallId,toolName:e.toolName,result:e.result,content:e.experimental_content,isError:e.isError,providerMetadata:e.experimental_providerMetadata})),providerMetadata:e.experimental_providerMetadata};default:throw new aI({role:r})}})(e,n))]}async function aj(e,t,r,a){let n=e.filter(e=>"user"===e.role).map(e=>e.content).filter(e=>Array.isArray(e)).flat().filter(e=>"image"===e.type||"file"===e.type).filter(e=>"image"!==e.type||!0!==r).map(e=>"image"===e.type?e.image:e.data).map(e=>"string"==typeof e&&(e.startsWith("http:")||e.startsWith("https:"))?new URL(e):e).filter(e=>e instanceof URL).filter(e=>!a(e));return Object.fromEntries((await Promise.all(n.map(async e=>({url:e,data:await t({url:e})})))).map(({url:e,data:t})=>[e.toString(),t]))}x=aA;var aO=rQ.lazy(()=>rQ.union([rQ.null(),rQ.string(),rQ.number(),rQ.boolean(),rQ.record(rQ.string(),aO),rQ.array(aO)])),aE=rQ.record(rQ.string(),rQ.record(rQ.string(),aO)),aP=rQ.array(rQ.union([rQ.object({type:rQ.literal("text"),text:rQ.string()}),rQ.object({type:rQ.literal("image"),data:rQ.string(),mimeType:rQ.string().optional()})])),aC=rQ.object({type:rQ.literal("text"),text:rQ.string(),experimental_providerMetadata:aE.optional()}),aR=rQ.object({type:rQ.literal("image"),image:rQ.union([aw,rQ.instanceof(URL)]),mimeType:rQ.string().optional(),experimental_providerMetadata:aE.optional()}),a$=rQ.object({type:rQ.literal("file"),data:rQ.union([aw,rQ.instanceof(URL)]),mimeType:rQ.string(),experimental_providerMetadata:aE.optional()}),aM=rQ.object({type:rQ.literal("tool-call"),toolCallId:rQ.string(),toolName:rQ.string(),args:rQ.unknown()}),aL=rQ.object({type:rQ.literal("tool-result"),toolCallId:rQ.string(),toolName:rQ.string(),result:rQ.unknown(),content:aP.optional(),isError:rQ.boolean().optional(),experimental_providerMetadata:aE.optional()}),aF=rQ.object({role:rQ.literal("system"),content:rQ.string(),experimental_providerMetadata:aE.optional()}),az=rQ.object({role:rQ.literal("user"),content:rQ.union([rQ.string(),rQ.array(rQ.union([aC,aR,a$]))]),experimental_providerMetadata:aE.optional()}),aU=rQ.object({role:rQ.literal("assistant"),content:rQ.union([rQ.string(),rQ.array(rQ.union([aC,aM]))]),experimental_providerMetadata:aE.optional()}),aD=rQ.object({role:rQ.literal("tool"),content:rQ.array(aL),experimental_providerMetadata:aE.optional()}),aV=rQ.union([aF,az,aU,aD]);function aq(e){return"object"==typeof e&&null!==e&&("function"===e.role||"data"===e.role||"toolInvocations"in e||"experimental_attachments"in e)?"has-ui-specific-parts":"object"==typeof e&&null!==e&&"content"in e&&(Array.isArray(e.content)||"experimental_providerMetadata"in e)?"has-core-specific-parts":"object"==typeof e&&null!==e&&"role"in e&&"content"in e&&"string"==typeof e.content&&["system","user","assistant","tool"].includes(e.role)?"message":"other"}var aB="AI_MessageConversionError",aK=`vercel.ai.error.${aB}`,aJ=Symbol.for(aK),aW=class extends j{constructor({originalMessage:e,message:t}){super({name:aB,message:t}),this[k]=!0,this.originalMessage=e}static isInstance(e){return j.hasMarker(e,aK)}};k=aJ,Q({prefix:"aiobj",size:24}),Q({prefix:"aiobj",size:24});var aY="AI_InvalidToolArgumentsError",aH=`vercel.ai.error.${aY}`,aG=Symbol.for(aH),aX=class extends j{constructor({toolArgs:e,toolName:t,cause:r,message:a=`Invalid arguments for tool ${t}: ${R(r)}`}){super({name:aY,message:a,cause:r}),this[w]=!0,this.toolArgs=e,this.toolName=t}static isInstance(e){return j.hasMarker(e,aH)}};w=aG;var aQ="AI_NoSuchToolError",a0=`vercel.ai.error.${aQ}`,a1=Symbol.for(a0),a9=class extends j{constructor({toolName:e,availableTools:t,message:r=`Model tried to call unavailable tool '${e}'. ${void 0===t?"No tools are available.":`Available tools: ${t.join(", ")}.`}`}){super({name:aQ,message:r}),this[T]=!0,this.toolName=e,this.availableTools=t}static isInstance(e){return j.hasMarker(e,a0)}};T=a1;var a4="AI_ToolCallRepairError",a2=`vercel.ai.error.${a4}`,a3=Symbol.for(a2),a6=class extends j{constructor({cause:e,originalError:t,message:r=`Error repairing tool call: ${R(e)}`}){super({name:a4,message:r,cause:e}),this[S]=!0,this.originalError=t}static isInstance(e){return j.hasMarker(e,a2)}};S=a3;var a5="AI_ToolExecutionError",a7=`vercel.ai.error.${a5}`,a8=Symbol.for(a7),ne=class extends j{constructor({toolArgs:e,toolName:t,cause:r,message:a=`Error executing tool ${t}: ${R(r)}`}){super({name:a5,message:a,cause:r}),this[Z]=!0,this.toolArgs=e,this.toolName=t}static isInstance(e){return j.hasMarker(e,a7)}};Z=a8;var nt=/^([\s\S]*?)(\s+)(\S*)$/;async function nr({toolCall:e,tools:t,repairToolCall:r,system:a,messages:n}){if(null==t)throw new a9({toolName:e.toolName});try{return await na({toolCall:e,tools:t})}catch(i){if(null==r||!(a9.isInstance(i)||aX.isInstance(i)))throw i;let s=null;try{s=await r({toolCall:e,tools:t,parameterSchema:({toolName:e})=>rH(t[e].parameters).jsonSchema,system:a,messages:n,error:i})}catch(e){throw new a6({cause:e,originalError:i})}if(null==s)throw i;return await na({toolCall:s,tools:t})}}async function na({toolCall:e,tools:t}){let r=e.toolName,a=t[r];if(null==a)throw new a9({toolName:e.toolName,availableTools:Object.keys(t)});let n=rH(a.parameters),s=""===e.args.trim()?et({value:{},schema:n}):er({text:e.args,schema:n});if(!1===s.success)throw new aX({toolName:r,toolArgs:e.args,cause:s.error});return{type:"tool-call",toolCallId:e.toolCallId,toolName:r,args:s.value}}var nn=Q({prefix:"aitxt",size:24});async function ns({model:e,tools:t,toolChoice:r,system:a,prompt:n,messages:s,maxRetries:i,abortSignal:o,headers:l,maxSteps:u=1,experimental_output:d,experimental_continueSteps:c=!1,experimental_telemetry:p,experimental_providerMetadata:m,experimental_activeTools:h,experimental_repairToolCall:f,_internal:{generateId:y=nn,currentDate:g=()=>new Date}={},onStepFinish:v,..._}){var b;if(u<1)throw new r6({parameter:"maxSteps",value:u,message:"maxSteps must be at least 1"});let{maxRetries:x,retry:k}=function({maxRetries:e}){if(null!=e){if(!Number.isInteger(e))throw new r6({parameter:"maxRetries",value:e,message:"maxRetries must be an integer"});if(e<0)throw new r6({parameter:"maxRetries",value:e,message:"maxRetries must be >= 0"})}let t=null!=e?e:2;return{maxRetries:t,retry:(({maxRetries:e=2,initialDelayInMs:t=2e3,backoffFactor:r=2}={})=>async a=>ar(a,{maxRetries:e,delayInMs:t,backoffFactor:r}))({maxRetries:t})}}({maxRetries:i}),w=function({model:e,settings:t,telemetry:r,headers:a}){var n;return{"ai.model.provider":e.provider,"ai.model.id":e.modelId,...Object.entries(t).reduce((e,[t,r])=>(e[`ai.settings.${t}`]=r,e),{}),...Object.entries(null!=(n=null==r?void 0:r.metadata)?n:{}).reduce((e,[t,r])=>(e[`ai.telemetry.metadata.${t}`]=r,e),{}),...Object.entries(null!=a?a:{}).reduce((e,[t,r])=>(void 0!==r&&(e[`ai.request.headers.${t}`]=r),e),{})}}({model:e,telemetry:p,headers:l,settings:{..._,maxRetries:x}}),T=function({prompt:e,tools:t}){if(null==e.prompt&&null==e.messages)throw new V({prompt:e,message:"prompt or messages must be defined"});if(null!=e.prompt&&null!=e.messages)throw new V({prompt:e,message:"prompt and messages cannot be defined at the same time"});if(null!=e.system&&"string"!=typeof e.system)throw new V({prompt:e,message:"system must be a string"});if(null!=e.prompt){if("string"!=typeof e.prompt)throw new V({prompt:e,message:"prompt must be a string"});return{type:"prompt",system:e.system,messages:[{role:"user",content:e.prompt}]}}if(null!=e.messages){let r=function(e){if(!Array.isArray(e))return"other";if(0===e.length)return"messages";let t=e.map(aq);return t.some(e=>"has-ui-specific-parts"===e)?"ui-messages":t.every(e=>"has-core-specific-parts"===e||"message"===e)?"messages":"other"}(e.messages);if("other"===r)throw new V({prompt:e,message:"messages must be an array of CoreMessage or UIMessage"});let a="ui-messages"===r?function(e,t){var r;let a=null!=(r=null==t?void 0:t.tools)?r:{},n=[];for(let t of e){let{role:e,content:r,toolInvocations:s,experimental_attachments:i}=t;switch(e){case"system":n.push({role:"system",content:r});break;case"user":n.push({role:"user",content:i?[{type:"text",text:r},...function(e){var t,r,a;let n=[];for(let s of e){let e;try{e=new URL(s.url)}catch(e){throw Error(`Invalid URL: ${s.url}`)}switch(e.protocol){case"http:":case"https:":if(null==(t=s.contentType)?void 0:t.startsWith("image/"))n.push({type:"image",image:e});else{if(!s.contentType)throw Error("If the attachment is not an image, it must specify a content type");n.push({type:"file",data:e,mimeType:s.contentType})}break;case"data:":{let e,t,i;try{[e,t]=s.url.split(","),i=e.split(";")[0].split(":")[1]}catch(e){throw Error(`Error processing data URL: ${s.url}`)}if(null==i||null==t)throw Error(`Invalid data URL format: ${s.url}`);if(null==(r=s.contentType)?void 0:r.startsWith("image/"))n.push({type:"image",image:aT(t)});else if(null==(a=s.contentType)?void 0:a.startsWith("text/"))n.push({type:"text",text:function(e){try{return new TextDecoder().decode(e)}catch(e){throw Error("Error decoding Uint8Array to text")}}(aT(t))});else{if(!s.contentType)throw Error("If the attachment is not an image or text, it must specify a content type");n.push({type:"file",data:t,mimeType:s.contentType})}break}default:throw Error(`Unsupported URL protocol: ${e.protocol}`)}}return n}(i)]:r});break;case"assistant":if(null==s){n.push({role:"assistant",content:r});break}n.push({role:"assistant",content:[{type:"text",text:r},...s.map(({toolCallId:e,toolName:t,args:r})=>({type:"tool-call",toolCallId:e,toolName:t,args:r}))]}),n.push({role:"tool",content:s.map(e=>{if(!("result"in e))throw new aW({originalMessage:t,message:"ToolInvocation must have a result: "+JSON.stringify(e)});let{toolCallId:r,toolName:n,result:s}=e,i=a[n];return(null==i?void 0:i.experimental_toToolResultContent)!=null?{type:"tool-result",toolCallId:r,toolName:n,result:i.experimental_toToolResultContent(s),experimental_content:i.experimental_toToolResultContent(s)}:{type:"tool-result",toolCallId:r,toolName:n,result:s}})});break;case"data":break;default:throw new aW({originalMessage:t,message:`Unsupported role: ${e}`})}}return n}(e.messages,{tools:t}):e.messages,n=et({value:a,schema:rQ.array(aV)});if(!n.success)throw new V({prompt:e,message:"messages must be an array of CoreMessage or UIMessage",cause:n.error});return{type:"messages",messages:a,system:e.system}}throw Error("unreachable")}({prompt:{system:null!=(b=null==d?void 0:d.injectIntoSystemPrompt({system:a,model:e}))?b:a,prompt:n,messages:s},tools:t}),S=function({isEnabled:e=!1,tracer:t}={}){return e?t||rG.trace.getTracer("ai"):an}(p);return ao({name:"ai.generateText",attributes:al({telemetry:p,attributes:{...aa({operationId:"ai.generateText",telemetry:p}),...w,"ai.prompt":{input:()=>JSON.stringify({system:a,prompt:n,messages:s})},"ai.settings.maxSteps":u}}),tracer:S,fn:async n=>{var s,i,b,x,Z,A,I;let N,j={type:"regular",...function({tools:e,toolChoice:t,activeTools:r}){return null!=e&&Object.keys(e).length>0?{tools:(null!=r?Object.entries(e).filter(([e])=>r.includes(e)):Object.entries(e)).map(([e,t])=>{let r=t.type;switch(r){case void 0:case"function":return{type:"function",name:e,description:t.description,parameters:rH(t.parameters).jsonSchema};case"provider-defined":return{type:"provider-defined",name:e,id:t.id,args:t.args};default:throw Error(`Unsupported tool type: ${r}`)}}),toolChoice:null==t?{type:"auto"}:"string"==typeof t?{type:t}:{type:"tool",toolName:t.toolName}}:{tools:void 0,toolChoice:void 0}}({tools:t,toolChoice:r,activeTools:h})},O=function({maxTokens:e,temperature:t,topP:r,topK:a,presencePenalty:n,frequencyPenalty:s,stopSequences:i,seed:o}){if(null!=e){if(!Number.isInteger(e))throw new r6({parameter:"maxTokens",value:e,message:"maxTokens must be an integer"});if(e<1)throw new r6({parameter:"maxTokens",value:e,message:"maxTokens must be >= 1"})}if(null!=t&&"number"!=typeof t)throw new r6({parameter:"temperature",value:t,message:"temperature must be a number"});if(null!=r&&"number"!=typeof r)throw new r6({parameter:"topP",value:r,message:"topP must be a number"});if(null!=a&&"number"!=typeof a)throw new r6({parameter:"topK",value:a,message:"topK must be a number"});if(null!=n&&"number"!=typeof n)throw new r6({parameter:"presencePenalty",value:n,message:"presencePenalty must be a number"});if(null!=s&&"number"!=typeof s)throw new r6({parameter:"frequencyPenalty",value:s,message:"frequencyPenalty must be a number"});if(null!=o&&!Number.isInteger(o))throw new r6({parameter:"seed",value:o,message:"seed must be an integer"});return{maxTokens:e,temperature:null!=t?t:0,topP:r,topK:a,presencePenalty:n,frequencyPenalty:s,stopSequences:null!=i&&i.length>0?i:void 0,seed:o}}(_),E=[],P=[],C=0,R=[],$="",M=[],L={completionTokens:0,promptTokens:0,totalTokens:0},F="initial";do{let r=0===C?T.type:"messages",n=[...T.messages,...R],h=await aN({prompt:{type:r,system:T.system,messages:n},modelSupportsImageUrls:e.supportsImageUrls,modelSupportsUrl:e.supportsUrl});N=await k(()=>ao({name:"ai.generateText.doGenerate",attributes:al({telemetry:p,attributes:{...aa({operationId:"ai.generateText.doGenerate",telemetry:p}),...w,"ai.prompt.format":{input:()=>r},"ai.prompt.messages":{input:()=>JSON.stringify(h)},"ai.prompt.tools":{input:()=>{var e;return null==(e=j.tools)?void 0:e.map(e=>JSON.stringify(e))}},"ai.prompt.toolChoice":{input:()=>null!=j.toolChoice?JSON.stringify(j.toolChoice):void 0},"gen_ai.system":e.provider,"gen_ai.request.model":e.modelId,"gen_ai.request.frequency_penalty":_.frequencyPenalty,"gen_ai.request.max_tokens":_.maxTokens,"gen_ai.request.presence_penalty":_.presencePenalty,"gen_ai.request.stop_sequences":_.stopSequences,"gen_ai.request.temperature":_.temperature,"gen_ai.request.top_k":_.topK,"gen_ai.request.top_p":_.topP}}),tracer:S,fn:async t=>{var a,n,s,i,u,c;let f=await e.doGenerate({mode:j,...O,inputFormat:r,responseFormat:null==d?void 0:d.responseFormat({model:e}),prompt:h,providerMetadata:m,abortSignal:o,headers:l}),v={id:null!=(n=null==(a=f.response)?void 0:a.id)?n:y(),timestamp:null!=(i=null==(s=f.response)?void 0:s.timestamp)?i:g(),modelId:null!=(c=null==(u=f.response)?void 0:u.modelId)?c:e.modelId};return t.setAttributes(al({telemetry:p,attributes:{"ai.response.finishReason":f.finishReason,"ai.response.text":{output:()=>f.text},"ai.response.toolCalls":{output:()=>JSON.stringify(f.toolCalls)},"ai.response.id":v.id,"ai.response.model":v.modelId,"ai.response.timestamp":v.timestamp.toISOString(),"ai.usage.promptTokens":f.usage.promptTokens,"ai.usage.completionTokens":f.usage.completionTokens,"gen_ai.response.finish_reasons":[f.finishReason],"gen_ai.response.id":v.id,"gen_ai.response.model":v.modelId,"gen_ai.usage.input_tokens":f.usage.promptTokens,"gen_ai.usage.output_tokens":f.usage.completionTokens}})),{...f,response:v}}})),E=await Promise.all((null!=(s=N.toolCalls)?s:[]).map(e=>nr({toolCall:e,tools:t,repairToolCall:f,system:a,messages:n}))),P=null==t?[]:await ni({toolCalls:E,tools:t,tracer:S,telemetry:p,messages:n,abortSignal:o});let Z=function({promptTokens:e,completionTokens:t}){return{promptTokens:e,completionTokens:t,totalTokens:e+t}}(N.usage);L={promptTokens:(I=L).promptTokens+Z.promptTokens,completionTokens:I.completionTokens+Z.completionTokens,totalTokens:I.totalTokens+Z.totalTokens};let A="done";++C<u&&(c&&"length"===N.finishReason&&0===E.length?A="continue":E.length>0&&P.length===E.length&&(A="tool-result"));let z=null!=(i=N.text)?i:"",U="continue"===F&&$.trimEnd()!==$?z.trimStart():z,D="continue"===A?function(e){let t,r=(t=e.match(nt))?{prefix:t[1],whitespace:t[2],suffix:t[3]}:void 0;return r?r.prefix+r.whitespace:e}(U):U;if($="continue"===A||"continue"===F?$+D:D,"continue"===F){let e=R[R.length-1];"string"==typeof e.content?e.content+=D:e.content.push({text:D,type:"text"})}else R.push(...function({text:e="",tools:t,toolCalls:r,toolResults:a}){let n=[];return n.push({role:"assistant",content:[{type:"text",text:e},...r]}),a.length>0&&n.push({role:"tool",content:a.map(e=>{let r=t[e.toolName];return(null==r?void 0:r.experimental_toToolResultContent)!=null?{type:"tool-result",toolCallId:e.toolCallId,toolName:e.toolName,result:r.experimental_toToolResultContent(e.result),experimental_content:r.experimental_toToolResultContent(e.result)}:{type:"tool-result",toolCallId:e.toolCallId,toolName:e.toolName,result:e.result}})}),n}({text:$,tools:null!=t?t:{},toolCalls:E,toolResults:P}));let V={stepType:F,text:D,toolCalls:E,toolResults:P,finishReason:N.finishReason,usage:Z,warnings:N.warnings,logprobs:N.logprobs,request:null!=(b=N.request)?b:{},response:{...N.response,headers:null==(x=N.rawResponse)?void 0:x.headers,messages:JSON.parse(JSON.stringify(R))},experimental_providerMetadata:N.providerMetadata,isContinued:"continue"===A};M.push(V),await (null==v?void 0:v(V)),F=A}while("done"!==F)return n.setAttributes(al({telemetry:p,attributes:{"ai.response.finishReason":N.finishReason,"ai.response.text":{output:()=>N.text},"ai.response.toolCalls":{output:()=>JSON.stringify(N.toolCalls)},"ai.usage.promptTokens":N.usage.promptTokens,"ai.usage.completionTokens":N.usage.completionTokens}})),new no({text:$,output:null==d?void 0:d.parseOutput({text:$},{response:N.response,usage:L}),toolCalls:E,toolResults:P,finishReason:N.finishReason,usage:L,warnings:N.warnings,request:null!=(Z=N.request)?Z:{},response:{...N.response,headers:null==(A=N.rawResponse)?void 0:A.headers,messages:R},logprobs:N.logprobs,steps:M,providerMetadata:N.providerMetadata})}})}async function ni({toolCalls:e,tools:t,tracer:r,telemetry:a,messages:n,abortSignal:s}){return(await Promise.all(e.map(async({toolCallId:e,toolName:i,args:o})=>{let l=t[i];if((null==l?void 0:l.execute)==null)return;let u=await ao({name:"ai.toolCall",attributes:al({telemetry:a,attributes:{...aa({operationId:"ai.toolCall",telemetry:a}),"ai.toolCall.name":i,"ai.toolCall.id":e,"ai.toolCall.args":{output:()=>JSON.stringify(o)}}}),tracer:r,fn:async t=>{try{let r=await l.execute(o,{toolCallId:e,messages:n,abortSignal:s});try{t.setAttributes(al({telemetry:a,attributes:{"ai.toolCall.result":{output:()=>JSON.stringify(r)}}}))}catch(e){}return r}catch(e){throw new ne({toolName:i,toolArgs:o,cause:e})}}});return{type:"tool-result",toolCallId:e,toolName:i,args:o,result:u}}))).filter(e=>null!=e)}var no=class{constructor(e){this.text=e.text,this.toolCalls=e.toolCalls,this.toolResults=e.toolResults,this.finishReason=e.finishReason,this.usage=e.usage,this.warnings=e.warnings,this.request=e.request,this.response=e.response,this.steps=e.steps,this.experimental_providerMetadata=e.providerMetadata,this.logprobs=e.logprobs,this.experimental_output=e.output}};r1({},{object:()=>nu,text:()=>nl});var nl=()=>({type:"text",responseFormat:()=>({type:"text"}),injectIntoSystemPrompt:({system:e})=>e,parseOutput:({text:e})=>e}),nu=({schema:e})=>{let t=rH(e);return{type:"object",responseFormat:({model:e})=>({type:"json",schema:e.supportsStructuredOutputs?t.jsonSchema:void 0}),injectIntoSystemPrompt:({system:e,model:r})=>r.supportsStructuredOutputs?e:function({prompt:e,schema:t,schemaPrefix:r=null!=t?"JSON schema:":void 0,schemaSuffix:a=null!=t?"You MUST answer with a JSON object that matches the JSON schema above.":"You MUST answer with JSON."}){return[null!=e&&e.length>0?e:void 0,null!=e&&e.length>0?"":void 0,r,null!=t?JSON.stringify(t):void 0,a].filter(e=>null!=e).join("\n")}({prompt:e,schema:t.jsonSchema}),parseOutput({text:e},r){let a=er({text:e});if(!a.success)throw new ap({message:"No object generated: could not parse the response.",cause:a.error,text:e,response:r.response,usage:r.usage});let n=et({value:a.value,schema:t});if(!n.success)throw new ap({message:"No object generated: response did not match schema.",cause:n.error,text:e,response:r.response,usage:r.usage});return n.value}}};function nd(e,t){let r,a,n=e.getReader(),s=t.getReader(),i=!1,o=!1;async function l(e){try{null==r&&(r=n.read());let t=await r;r=void 0,t.done?e.close():e.enqueue(t.value)}catch(t){e.error(t)}}async function u(e){try{null==a&&(a=s.read());let t=await a;a=void 0,t.done?e.close():e.enqueue(t.value)}catch(t){e.error(t)}}return new ReadableStream({async pull(e){try{if(i)return void await u(e);if(o)return void await l(e);null==r&&(r=n.read()),null==a&&(a=s.read());let{result:t,reader:d}=await Promise.race([r.then(e=>({result:e,reader:n})),a.then(e=>({result:e,reader:s}))]);t.done||e.enqueue(t.value),d===n?(r=void 0,t.done&&(await u(e),i=!0)):(a=void 0,t.done&&(o=!0,await l(e)))}catch(t){e.error(t)}},cancel(){n.cancel(),s.cancel()}})}function nc(e={}){let t=new TextEncoder,r="";return new TransformStream({async start(){e.onStart&&await e.onStart()},async transform(a,n){n.enqueue(t.encode(a)),r+=a,e.onToken&&await e.onToken(a),e.onText&&"string"==typeof a&&await e.onText(a)},async flush(){e.onCompletion&&await e.onCompletion(r),e.onFinal&&await e.onFinal(r)}})}function np(e,t){return e.pipeThrough(new TransformStream({transform:async(e,t)=>{var r;if("string"==typeof e)return void t.enqueue(e);if("event"in e){"on_chat_model_stream"===e.event&&ny(null==(r=e.data)?void 0:r.chunk,t);return}ny(e,t)}})).pipeThrough(nc(t)).pipeThrough(new TextDecoderStream).pipeThrough(new TransformStream({transform:async(e,t)=>{t.enqueue(rW("text",e))}}))}function nm(e,t){return np(e,t).pipeThrough(new TextEncoderStream)}function nh(e,t){var r;let a=np(e,null==t?void 0:t.callbacks).pipeThrough(new TextEncoderStream),n=null==t?void 0:t.data,s=null==t?void 0:t.init;return new Response(n?nd(n.stream,a):a,{status:null!=(r=null==s?void 0:s.status)?r:200,statusText:null==s?void 0:s.statusText,headers:r9(null==s?void 0:s.headers,{contentType:"text/plain; charset=utf-8",dataStreamVersion:"v1"})})}function nf(e,t){t.dataStream.merge(np(e,t.callbacks))}function ny(e,t){if("string"==typeof e.content)t.enqueue(e.content);else for(let r of e.content)"text"===r.type&&t.enqueue(r.text)}function ng(e,t){var r;let a,n=(a=!0,e=>(a&&(e=e.trimStart())&&(a=!1),e));return(r=e[Symbol.asyncIterator](),new ReadableStream({async pull(e){try{let{value:t,done:a}=await r.next();a?e.close():e.enqueue(t)}catch(t){e.error(t)}},cancel(){}})).pipeThrough(new TransformStream({async transform(e,t){t.enqueue(n(e.delta))}})).pipeThrough(nc(t)).pipeThrough(new TextDecoderStream).pipeThrough(new TransformStream({transform:async(e,t)=>{t.enqueue(rW("text",e))}}))}function nv(e,t){return ng(e,t).pipeThrough(new TextEncoderStream)}function n_(e,t={}){var r;let{init:a,data:n,callbacks:s}=t,i=ng(e,s).pipeThrough(new TextEncoderStream);return new Response(n?nd(n.stream,i):i,{status:null!=(r=null==a?void 0:a.status)?r:200,statusText:null==a?void 0:a.statusText,headers:r9(null==a?void 0:a.headers,{contentType:"text/plain; charset=utf-8",dataStreamVersion:"v1"})})}function nb(e,t){t.dataStream.merge(ng(e,t.callbacks))}Q({prefix:"aitxt",size:24}),Symbol.for("vercel.ai.error.AI_NoSuchProviderError"),r1({},{mergeIntoDataStream:()=>nf,toDataStream:()=>nm,toDataStreamResponse:()=>nh}),r1({},{mergeIntoDataStream:()=>nb,toDataStream:()=>nv,toDataStreamResponse:()=>n_}),e.s(["generateText",()=>ns],65209)}];

//# sourceMappingURL=node_modules__pnpm_cde9eff5._.js.map