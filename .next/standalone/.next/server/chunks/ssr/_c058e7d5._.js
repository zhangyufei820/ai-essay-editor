module.exports=[84435,a=>{"use strict";let b=(0,a.i(61237).default)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);a.s(["Loader2",()=>b],84435)},69964,a=>{"use strict";let b=(0,a.i(61237).default)("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);a.s(["CheckCircle2",()=>b],69964)},11374,a=>{"use strict";let b=(0,a.i(61237).default)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);a.s(["ArrowLeft",()=>b],11374)},65602,a=>{"use strict";var b=a.i(8398),c=a.i(42261),d=a.i(97895);let e=(0,c.cva)("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function f({className:a,variant:c,...f}){return(0,b.jsx)("div",{"data-slot":"alert",role:"alert",className:(0,d.cn)(e({variant:c}),a),...f})}function g({className:a,...c}){return(0,b.jsx)("div",{"data-slot":"alert-description",className:(0,d.cn)("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",a),...c})}a.s(["Alert",()=>f,"AlertDescription",()=>g])},88811,a=>{"use strict";let b=(0,a.i(61237).default)("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);a.s(["ExternalLink",()=>b],88811)},64993,a=>{"use strict";var b=a.i(8398),c=a.i(81934);let d=[{id:"basic",name:"基础版",description:"适合入门体验",priceInCents:2800,features:["每月 2,000 积分","调用所有 AI 模型","标准生成速度","社区支持","调用专业智能体"]},{id:"pro",name:"专业版",description:"适合高频学生",priceInCents:6800,features:["每月 5,000 积分","调用所有 AI 模型","优先生成速度","高级润色工具","名师辅导 (1次/月)","调用专业智能体"],popular:!0},{id:"premium",name:"豪华版",description:"适合重度用户/教育者",priceInCents:12800,features:["每月 12,000 积分","调用三大顶尖模型","最高优先速度","高级润色工具","名师辅导 (2次/月)","无限次 AI 对话","调用专业智能体"]},{id:"credits-500",name:"500 积分充值包",description:"永久有效，适合轻度或测试用户",priceInCents:500,features:["500 积分","永久有效","可用于生成作文或兑换辅导"]},{id:"credits-1000",name:"1000 积分充值包",description:"永久有效，适合轻度或测试用户",priceInCents:1e3,features:["1000 积分","永久有效","可用于生成作文或兑换辅导"]},{id:"credits-5000",name:"5000 积分充值包",description:"永久有效 (96折优惠)",priceInCents:4800,features:["5000 积分","永久有效","可用于生成作文或兑换辅导"]},{id:"credits-10000",name:"10000 积分充值包",description:"永久有效 (9折优惠)",priceInCents:9e3,features:["10000 积分","永久有效","可用于生成作文或兑换辅导"]}];var e=a.i(11374),f=a.i(84435),g=a.i(69964),h=a.i(88811),i=a.i(30301),j=a.i(40695);let k=!0;var l=a.i(11523),m=a.i(69240),n=a.i(65602);function o({productId:a}){let o=(0,c.useRouter)(),p=(0,c.useSearchParams)(),q=d.find(b=>b.id===a),[r,s]=(0,l.useState)(null),[t,u]=(0,l.useState)(!0),[v,w]=(0,l.useState)(!1),[x,y]=(0,l.useState)(null),z=p.get("billing")||"monthly";(0,l.useEffect)(()=>{(async()=>{try{let a=(0,m.createClient)(),b=null;if(a){let{data:c}=await a.auth.getUser();b=c.user}if(b)s(b);else{let a=localStorage.getItem("currentUser");if(a)try{s(JSON.parse(a))}catch(a){console.error(a)}}}catch(a){console.error(a)}finally{u(!1)}})()},[]),q||(0,c.notFound)();let A=q.priceInCents,B=`/checkout/${a}?billing=${z}`,C=`/login?redirect=${encodeURIComponent(B)}`,D=async b=>{if(y(null),!r)return void o.push(C);w(!0);try{let c=r.id||r.sub||r.user_id;if(!c){alert("无法获取用户信息，请重新登录"),o.push(C),w(!1);return}let d=`/api/payment/xunhupay/create?productId=${a}&type=${b}&billing=${z}&userId=${c}`,e=await fetch(d),f=await e.json();if(!e.ok)throw Error(f.error||"请求失败");let g=f.url||f.pay_url||f.link;if(g){let a=document.createElement("a");a.href=g,a.target="_self",document.body.appendChild(a),a.click(),document.body.removeChild(a),setTimeout(()=>{w(!1),y(g)},2e3)}else throw Error("未返回支付链接")}catch(a){console.error(a),alert("支付初始化失败: "+a.message),w(!1)}};return t?(0,b.jsx)("div",{className:"min-h-screen bg-gradient-to-b from-background to-muted/20 flex items-center justify-center",children:(0,b.jsx)(f.Loader2,{className:"h-8 w-8 animate-spin text-primary"})}):(0,b.jsx)("div",{className:"min-h-screen bg-gradient-to-b from-background to-muted/20",children:(0,b.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,b.jsxs)(i.default,{href:"/#pricing",className:"inline-flex items-center gap-2 text-sm text-muted-foreground hover:text-foreground mb-8",children:[(0,b.jsx)(e.ArrowLeft,{className:"h-4 w-4"})," 返回定价"]}),(0,b.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,b.jsxs)("div",{className:"bg-card rounded-2xl shadow-lg p-8 mb-8",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold mb-2",children:q.name}),(0,b.jsx)("p",{className:"text-muted-foreground mb-4",children:q.description}),(0,b.jsxs)("div",{className:"text-4xl font-bold text-primary mb-6",children:["¥",(A/100).toFixed(2),(0,b.jsxs)("span",{className:"text-lg text-muted-foreground ml-2",children:["/ ","annual"===z?"年":"monthly"===z?"月":"次"]})]})]}),x&&(0,b.jsxs)(n.Alert,{className:"mb-6 border-green-200 bg-green-50",children:[(0,b.jsx)(g.CheckCircle2,{className:"h-4 w-4 text-green-600"}),(0,b.jsxs)(n.AlertDescription,{className:"text-green-900 flex items-center gap-2",children:["支付链接已生成！如果浏览器未自动跳转，请点击：",(0,b.jsxs)("a",{href:x,className:"font-bold underline flex items-center",target:"_blank",rel:"noopener noreferrer",children:["立即前往支付 ",(0,b.jsx)(h.ExternalLink,{className:"h-3 w-3 ml-1"})]})]})]}),(0,b.jsxs)("div",{className:"bg-card rounded-2xl shadow-lg p-8",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"选择支付方式"}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[(0,b.jsx)(j.Button,{variant:"outline",className:"h-auto py-4 flex flex-col items-center gap-2",onClick:()=>D("alipay"),disabled:!k||v,children:v?(0,b.jsx)(f.Loader2,{className:"h-6 w-6 animate-spin text-primary"}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("svg",{className:"h-8 w-8",viewBox:"0 0 24 24",fill:k?"#1677FF":"#999",children:(0,b.jsx)("path",{d:"M18.277 3H5.723A2.723 2.723 0 003 5.723v12.554A2.723 2.723 0 005.723 21h12.554A2.723 2.723 0 0021 18.277V5.723A2.723 2.723 0 0018.277 3zm1.305 13.739c-1.134.452-2.344.804-3.604 1.044-.975-1.127-1.82-2.408-2.504-3.808h3.208v-1.283h-3.77v-1.095h3.77V10.31h-3.77V9.215h3.77V7.932h-8.285v1.283h3.77v1.095h-3.77v1.287h3.77v1.283h-3.77c-.684 1.4-1.529 2.681-2.504 3.808-1.26-.24-2.47-.592-3.604-1.044v-2.168h8.285v-1.283H4.418V9.215h8.285V7.932H4.418V5.723c0-.753.61-1.363 1.363-1.363h12.438c.753 0 1.363.61 1.363 1.363v11.016z"})}),(0,b.jsx)("span",{className:"font-medium text-sm",children:"支付宝"})]})}),(0,b.jsx)(j.Button,{variant:"outline",className:"h-auto py-4 flex flex-col items-center gap-2",onClick:()=>D("wechat"),disabled:!k||v,children:v?(0,b.jsx)(f.Loader2,{className:"h-6 w-6 animate-spin text-primary"}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("svg",{className:"h-8 w-8",viewBox:"0 0 24 24",fill:k?"#07C160":"#999",children:(0,b.jsx)("path",{d:"M8.691 2.188C3.891 2.188 0 5.476 0 9.53c0 2.212 1.17 4.203 3.002 5.55a.59.59 0 0 1 .213.665l-.39 1.48c-.019.07-.048.141-.048.213 0 .163.13.295.29.295a.326.326 0 0 0 .167-.054l1.903-1.114a.864.864 0 0 1 .717-.098 10.16 10.16 0 0 0 2.837.403c.276 0 .543-.027.811-.05-.857-2.578.157-4.972 1.932-6.446 1.703-1.415 3.882-1.98 5.853-1.838-.576-3.583-4.196-6.348-8.596-6.348zM5.785 5.991c.642 0 1.162.529 1.162 1.18a1.17 1.17 0 0 1-1.162 1.178A1.17 1.17 0 0 1 4.623 7.17c0-.651.52-1.18 1.162-1.18zm5.813 0c.642 0 1.162.529 1.162 1.18a1.17 1.17 0 0 1-1.162 1.178 1.17 1.17 0 0 1-1.162-1.178c0-.651.52-1.18 1.162-1.18zm5.34 2.867c-1.797-.052-3.746.512-5.28 1.786-1.72 1.428-2.687 3.72-1.78 6.22.942 2.453 3.666 4.229 6.884 4.229.826 0 1.622-.12 2.361-.336a.722.722 0 0 1 .598.082l1.584.926a.272.272 0 0 0 .14.047c.134 0 .24-.111.24-.247 0-.06-.023-.12-.038-.177l-.327-1.233a.582.582 0 0 1-.023-.156.49.49 0 0 1 .201-.398C23.024 18.48 24 16.82 24 14.98c0-3.21-2.931-5.837-6.656-6.088V8.89c-.135-.01-.27-.027-.407-.03zm-2.53 3.274c.535 0 .969.44.969.982a.976.976 0 0 1-.969.983.976.976 0 0 1-.969-.983c0-.542.434-.982.969-.982zm4.844 0c.535 0 .969.44.969.982a.976.976 0 0 1-.969.983.976.976 0 0 1-.969-.983c0-.542.434-.982.969-.982z"})}),(0,b.jsx)("span",{className:"font-medium text-sm",children:"微信支付"})]})})]})]})]})]})})}function p({params:a}){let{productId:c}=(0,l.use)(a);return(0,b.jsx)(l.Suspense,{fallback:(0,b.jsx)("div",{children:"Loading..."}),children:(0,b.jsx)(o,{productId:c})})}a.s(["default",()=>p],64993)}];

//# sourceMappingURL=_c058e7d5._.js.map